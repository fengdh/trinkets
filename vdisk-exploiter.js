(function($, options) {
  var global = this;
  var jqmap = global._jQuery_map = global._jQuery_map || {}
  
  $.noConflict();
  jQuery.getScript('https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js', go);
  
  function go() {
    $ = jQuery;
    options = $.extend({pageSize: 100, maxRequest: 50}, options);

    // 有数量限定的执行令牌池，用来限定并发请求的数量避免负荷过大
    var pool = (function create_pool(size) {
      var used = 0, pending = [], t;

      return {
        get: function() {
          var wait = $.Deferred();
          used++ < size ? wait.resolve(used) : pending.push(wait);
          return wait.promise({ free: function() {
              if (used > 0 && wait) {
                pending.length > 0 && pending.shift().resolve(used);
                used--; wait = null;
              }
            }});
        }
      }
    })(options.conn_max = Math.max(options.maxRequest, 1));
    
    // 封装$.ajax()调用，在并发执行的同时通过令牌池来限制请求符合，提高转存成功率
    function $ajax() {
      var slot = pool.get(), args = [].slice.apply(arguments);
      return slot.pipe(function () {
        return $.ajax.apply(null, args).done(slot.free).fail(slot.free);
      });
    }    
    
    var uid = options.uid;
    
    var API = {items: {url: '/wap/api/weipan/listUserItems', dataType: 'json'},
                info: {url: '/user/info', dataType: 'json' } };
    
    function data(api, data) {
      return $.extend({}, API.items, {data: data});
    }
    
    function listItems() {
      return $ajax(data(API.items, {uid: uid, page_size: options.pageSize, page: 1}))
        .then(function(r) {
          var arr = r.data || [], max = r.totalnum, pg = 2, cnt = arr.length;
max = Math.min(max, 200);
          if (cnt < max) {
            var jobs = [];
            while (cnt < max) {
              jobs.push(data(API.items, {uid: uid, page_size: options.pageSize, page: pg++}));
              cnt += options.pageSize;
            }
            return $.when.apply(null, jobs.map(j => $ajax(j).then(r => r)))
                    .then(function() {
                        [].slice.apply(arguments).forEach(r => r.data && [].push.apply(arr, r.data));
                        return arr;
                    });

          }
          return arr;
        });
    }
    
    function ls(item) {
      console.log(item);
    }
  
    listItems().then(v => v.map(ls));
  
  }
}) ($, 
    {
      uid: '1412362930',
//      uid: '1791495232'
    });

/*//

$.ajax({url: '/wap/s/FA8-2-H6cDzri', success: function(html) { 
  var lines = html.split('\n');
  //lines = lines.map(d => d.substr(0, 17));
  lines = lines.filter(d => d.substr(0, 13) === '	detail.init(').map( d => JSON.parse(d.substring(13, d.length-3)));
  console.log(lines[0])
}})

//*/

define("page/user_share", ["../core", "../common"], function (require, a, b) {
  var c = require("../core");
  require("../common");
  var d = {
    init: function (a) {
      this.uid = a, this.$container = $(".suggest_file"), this.bind(), this.more = new c.More(".pagemore a", this.load), this.more.trigger()
    },
    bind: function () {
      this.$container.on("click", ".feedlist", function () {
        window.location.href = APP_URL + "s/" + $(this).data("copy-ref")
      })
    },
    load: function (a) {
      var b = d;
      c.api({
        url: "api/weipan/listUserItems",
        data: {
          uid: b.uid,
          page: a,
          page_size: 10
        }
      }, function (c) {
        void 0 === typeof c.data && (c.data = []);
        var d = Math.ceil(c.totalnum / 10);
        a >= d || 0 === c.data.length ? b.more.finished() : b.more.success(), b.appendData(c.data)
      }, function (a) {
        b.more.error()
      })
    },
    appendData: function (a) {
      for (var b = "", c = 0; c < a.length; c++) b += this.format(a[c]);
      this.$container.find(".feedlist").last().removeClass("last"), this.$container.append(b), this.$container.find(".feedlist").last().addClass("last")
    },
    format: function (a) {
      var b = a.name;
      if (a.is_dir) var d = "folder",
        e = "";
      else var d = c.icon(b),
        e = c.format.formatsize(a.bytes);
      var f = parseInt(a.count_download) + parseInt(a.count_copy);
      return '            <div class="feedlist" data-copy-ref="' + a.copy_ref + '">                <div class="icon"><span class="wap_icon icon_' + d + '"></span></div>                <div class="content"><p class="tit"><a>' + c.text.encodeHtml(b) + "</a></p><p><span>" + e + "</span>下载量（" + f + "）</p></div>            </div>            "
    }
  };
  return d
}), define("core", [], function (require, a, b) {
  var c = {};
  return c.login = function () {
    window.location.href = APP_URL + "account/login"
  }, c.tips = {
    clear: function () {
      $("#tips").html("")
    },
    success: function (a) {
      $("#tips").html('<div class="save_ok_wrap">                <div class="save_ok"><img src="' + STATIC_URL + 'images/wapImg/save_ok.png" width="16" height="13">' + a + "</div>            </div>")
    },
    error: function (a) {
      $("#tips").html('<div class="save_ok_wrap">                <div class="login_error_tips"><img src="' + STATIC_URL + 'images/wapImg/error1.png" width="12" height="12"><span>' + a + "</span></div>            </div>")
    }
  }, c.cookie = {
    set: function (a, b, c) {
      var d = (new Date).getTime();
      d += 1e3 * c * 60 * 60;
      var e = a + "=" + escape(b) + ";expires=" + new Date(d).toGMTString() + ";path=/";
      document.cookie = e
    },
    get: function (a) {
      var b = document.cookie.split("; "),
        c = 0;
      for (c = 0; c < b.length; c++) {
        var d = b[c].split("=");
        if (d[0] == a) return unescape(d[1])
      }
      return ""
    },
    remove: function (a) {
      var b = a + "=''" + escape("null") + ";expires=" + (new Date).toGMTString();
      document.cookie = b
    }
  }, c.More = function (a, b, c) {
    function d() {
      l.off("touchmove", e), h = null, i = null, k = !1
    }

    function e(a) {
      if (k) {
        var b = a.touches[0].pageY,
          c = h - b,
          e = $(window).scrollTop();
        c > j && c - j > e - i && e + $(window).height() >= l.height() - 65 && (d(), g.trigger())
      }
    }

    function f(a) {
      1 == a.touches.length && (h = a.touches[0].pageY, i = $(window).scrollTop(), k = !0, l.on("touchmove", e))
    }
    var g = this;
    this.$element = $(a), this.loadingHtml = '<img width="16" class="moreLoading" src="' + STATIC_URL + 'images/wapImg/loading_black.gif">', this.callback = b, this.reset(), void 0 !== c && (this.page = 1), this.status = 0, this.$element.click(function () {
      g.trigger()
    });
    var h, i, j = 20,
      k = !1,
      l = $(document);
    l.on("touchstart", f)
  }, c.More.prototype = {
    getPage: function () {
      return this.page
    },
    loading: function () {
      this.$element.html(this.loadingHtml + "加载中...").show(), this.status = 1
    },
    success: function () {
      this.$element.html("更多...").show(), this.status = 2, this.page++
    },
    error: function (a) {
      void 0 === a && (a = "加载失败"), this.$element.html('<span style="color:red;">' + a + "</span>").show(), this.status = -1
    },
    finished: function () {
      this.$element.find("img").hide(), 1 == this.status && this.page++, this.status = 3, this.$element.hide()
    },
    trigger: function (a) {
      void 0 === a && (a = this.page + 1), (0 == this.status || 2 == this.status || -1 == this.status) && (this.loading(), this.callback(a))
    },
    reset: function () {
      this.$element.show(), this.$element.find("img").hide(), this.status = 0, this.page = 0
    }
  }, c.api = function (a, b, d, e) {
    var f = {
      cache: !1,
      validate: function (a) {
        return null !== a
      }
    };
    return a = $.extend({}, a, f), a.url.indexOf("://") > -1 || "/" === a.url[0] || (a.url = APP_URL + a.url), a.dataType = "json", a.success = function (e) {
      a.validate(e) ? null !== e && "object" == typeof e && e.error_code ? "A401" === e.error_code ? c.login() : d && d(e) : b && b(e) : d && d({
        error_code: "A500",
        error: "加载失败"
      })
    }, a.error = function (a, b, c) {
      d && d({
        error_code: "A000",
        error: "加载失败了！"
      })
    }, a.complete = function (a, b) {
      e && e(a, b)
    }, $.ajax(a)
  }, c.api.get = function () {
    return c.api.apply(null, arguments)
  }, c.api.post = function () {
    return arguments[0].type = "POST", c.api.apply(null, arguments)
  }, c.ua = function () {
    var a = window.navigator.userAgent,
      b = {
        android: a.indexOf("Android") > 0,
        ios: a.indexOf("iPhone") > 0 || a.indexOf("iPad") > 0 || a.indexOf("iPod") > 0,
        windowsphone: a.indexOf("Windows Phone") > 0,
        ios9: (a.indexOf("iPhone") > 0 || a.indexOf("iPad") > 0 || a.indexOf("iPod") > 0) && a.indexOf("Version/9.0") > 0,
        wechat: a.indexOf("micromessenger"),
        qq: !1,
        baidu: !1,
        firefox: !1,
        opera: !1,
        opera_mini: !1,
        opera_mobile: !1,
        uc: !1,
        dolphin: !1,
        maxthon: !1,
        chrome: !1,
        safari: !1
      };
    return (_match = a.match(/baidu/)) ? b.baidu = !0 : (_match = a.match(/360browser/)) ? b.qihu = !0 : (_match = a.match(/MQQBrowser\/([\d\.]+)/)) ? (b.qq = !0, b.qq_version = _match[1]) : (_match = a.match(/Firefox\/([\d\.]+)/)) ? (b.firefox = !0, b.firefox_version = _match[1]) : (_match = a.match(/Opera Mini\/([\d\.]+)/)) ? (b.opera = !0, b.opera_mini = !0, b.opera_mini_version = _match[1], b.opera_version = _match[1]) : (_match = a.match(/Opera Mobi/)) ? (b.opera = !0, b.opera_mobile = !0) : (_match = a.match(/UC/)) ? (b.uc = !0, b.uc_version = null) : (_match = a.match(/Chrome\/([\d\.]+)/)) ? (b.chrome = !0, b.chrome_version = _match[1]) : (_match = a.match(/CriOS\/([\d\.]+)/)) ? (b.chrome = !0, b.chrome_version = _match[1]) : (_match = b.ios && (_match = a.match(/Safari\/([\d\.]+)/))) && (b.safari = !0, b.safari_version = _match[1]), b
  }(), c.path = {
    basename: function (a, b) {
      var c = a.replace(/^.*[\/\\]/g, "");
      return "string" == typeof b && c.substr(c.length - b.length) == b && (c = c.substr(0, c.length - b.length)), c
    },
    dirname: function (a) {
      return a.replace(/\\/g, "/").replace(/\/[^\/]*\/?$/, "")
    },
    extension: function (a, b) {
      var d = c.path.basename(a),
        e = "";
      return d.indexOf(".") > -1 && (e = d.split(".").pop(), b && (e = e.toLowerCase(e))), e
    }
  }, c.icon = function (a) {
    for (var b = [["pic", ["ai", "bmp", "gif", "jpeg", "jpg", "png", "psd", "mpeg", "raw"]], ["apk", ["apk"]], ["ipa", ["ipa"]], ["csv", ["csv"]], ["epub", ["epub"]], ["txt", ["txt", "rtf"]], ["wps", ["wps"]], ["doc", ["doc", "docx"]], ["pdf", ["pdf"]], ["ppt", ["pps", "ppsx", "ppt", "pptx"]], ["xls", ["xlsx", "xls"]], ["music", ["mp3", "wma", "aac", "ape", "flac"]], ["video", ["ai", "mov", "mpeg", "wav", "raw", "mp4", "rmvb"]], ["exe", ["exe"]], ["swf", ["swf"]], ["xap", ["xap"]], ["html", ["html"]], ["rar", ["rar", "zip"]]], d = c.path.extension(a, !0), e = b.length - 1; e >= 0; e--)
      for (var f = b[e][1].length - 1; f >= 0; f--)
        if (b[e][1][f] === d) return b[e][0];
    return "other"
  }, c.format = {
    formatsize: function (a, b) {
      var c = ["B", "K", "M", "G", "T", "P", "E", "Z", "Y"],
        d = 0;
      for (void 0 === b && (b = 2); a > 1024;) a /= 1024, ++d;
      if (a % 1 == 0) return a + "" + c[d];
      var e = Math.pow(10, b);
      return "" + Math.round(a * e) / e + c[d]
    },
    formatDate: function (a) {
      var b = a.getHours(),
        c = a.getMinutes();
      return 10 > b && (b = "0" + b), 10 > c && (c = "0" + c), a.getFullYear() + "-" + (a.getMonth() + 1) + "-" + a.getDate() + " " + b + ":" + c
    },
    formatDateString: function (a) {
      var b = new Date(a);
      return this.formatDate(b)
    },
    formatTimestamp: function (a) {
      var b = new Date(1e3 * a);
      return this.formatDate(b)
    },
    formatMyDate: function (a, b) {
      if (void 0 == a) return "";
      var c = new Date(1e3 * a),
        d = new Date(1e3 * b),
        e = c.getMinutes(),
        f = c.getHours();
      if (c.getFullYear() == d.getFullYear() && c.getMonth() + 1 == d.getMonth() + 1 && c.getDate() == d.getDate()) return 10 > e && (e = "0" + e), 10 > f && (f = "0" + f), "今天 " + f + ":" + e;
      10 > e && (e = "0" + e), 10 > f && (f = "0" + f);
      var g = c.getFullYear() + "-" + (c.getMonth() + 1) + "-" + c.getDate() + " " + f + ":" + e;
      return g
    }
  }, c.text = {
    mbCut: function (a, b, c) {
      var d = 0,
        e = "",
        f = /[^\x00-\xff]/g,
        g = "",
        h = a.replace(f, "**").length;
      void 0 === b && (b = 18), b *= 2;
      for (var i = 0; h > i && (g = a.charAt(i).toString(), null != g.match(f) ? d += 2 : d++, !(d > b)); i++) e += g;
      return c !== !1 && h > b && (e += "..."), e
    },
    mbWidth: function (a) {},
    encodeHtml: function (a, b) {
      return void 0 === b && (b = 3), a = a.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"), (1 == b || 3 == b) && (a = a.replace(/'/g, "&#039;")), (2 == b || 3 == b) && (a = a.replace(/"/g, "&quot")), a
    }
  }, c.swipe = function (a, b) {
    function c() {
      a.off("touchmove", d), g = null, i = !1
    }

    function d(a) {
      if (f.preventDefaultEvents && a.preventDefault(), i) {
        var b = a.touches[0].pageX,
          d = a.touches[0].pageY,
          e = g - b,
          j = h - d;
        Math.abs(e) >= f.min_move_x ? (c(), e > 0 ? f.swipeLeft() : f.swipeRight()) : Math.abs(j) >= f.min_move_y && (c(), 0 > j ? f.swipeDown() : f.swipeUp(Math.abs(j) - f.min_move_y))
      }
    }

    function e(b) {
      1 == b.touches.length && (g = b.touches[0].pageX, h = b.touches[0].pageY, i = !0, f.touchStart && f.touchStart(), a.on("touchmove", d))
    }
    var f = {
      min_move_x: 20,
      min_move_y: 20,
      swipeLeft: function () {},
      swipeRight: function () {},
      swipeUp: function () {},
      swipeDown: function () {},
      preventDefaultEvents: !1
    };
    b && $.extend(f, b);
    var g, h, i = !1;
    a.on("touchstart", e)
  }, c
}), define("common", ["core"], function (require, a, b) {
  var c = require("core");
  if ($(".v_ads_detail a").length) {
    var d = c.ua,
      e = "";
    e = d.ios ? "http://itunes.apple.com/cn/app/id422038334?mt=8" : d.windowphone ? "http://www.windowsphone.com/zh-cn/store/app/微盘/7718ed42-a93b-4c6f-9b4b-4eb3c278084f" : "http://www.weipan.cn/download/vdisk.apk", $(".v_ads_detail a").attr("href", e)
  }
  $(document).bind("click", function (a) {
    var b = $(a.target);
    0 == b.closest("#linklist").length && $("#linklist").hide()
  }), "none" != c.cookie.get("appLayer") && $("#appLayer").show(), $("#closeApp").click(function () {
    $("#appLayer").hide(), c.cookie.set("appLayer", "none", 24)
  });
  var f = {
    create: function (a, b) {
      c.api({
        url: "api/weibo/2/friendships/create.json",
        type: "POST",
        data: {
          uid: a
        }
      }, function (a) {
        a.id && b()
      }, function (a) {
        error(a)
      })
    },
    isfriendships: function (a, b, d) {
      c.api({
        url: "api/weibo/2/friendships/show.json",
        type: "GET",
        data: {
          source_id: a,
          target_id: b
        }
      }, function (a) {
        a.target.followed_by && d()
      }, function (a) {
        error(a)
      })
    }
  };
  $(".focus_btn").click(function (a) {
    if (a.preventDefault(), !UID) return c.login(), !1;
    var b = $(".focus_btn").data("attention"),
      d = $(".focus_btn").data("uid");
    "n" == b && f.create(d, g)
  });
  var g = function () {
    $(".focus_btn").data("attention", "y"), $(".focus_btn").html("已关注")
  };
  UID && f.isfriendships(UID, 1796469287, g);
  var h = function () {
    $(".focus_even_btn.follow_btn").data("attention", "y"), $(".focus_even_btn.follow_btn").html("已关注")
  };
  UID && $(".focus_even_btn.follow_btn").length > 0 && f.isfriendships(UID, $(".focus_even_btn.follow_btn").data("uid"), h), $(".focus_even_btn.follow_btn").click(function () {
    if (!UID) return c.login(), !1;
    var a = $(".focus_even_btn.follow_btn").data("attention"),
      b = $(".focus_even_btn.follow_btn").data("uid");
    "n" == a && f.create(b, h)
  });
  var i = {
    size: 0,
    star: 1,
    member_bonus: 0,
    sentweibo_size: 0,
    quota: 0,
    init: function () {
      var a = this;
      this.checkin_info(function () {
        a.checkin_show()
      }), this.bind()
    },
    checkin_info: function (a) {
      var b = this;
      c.api({
        url: "api/weipan/2/checkin/checkin_info"
      }, function (c) {
        c !== !1 && (b.size = parseInt(c.size), b.star = c.star, b.sentweibo_size = parseInt(c.sent_weibo_size), b.quota = parseInt(c.quota), void 0 != a && a())
      }, function (a) {})
    },
    checkin: function () {
      if (!UID) return c.login(), !1;
      var a = this;
      c.api({
        url: "api/weipan/checkin",
        type: "GET"
      }, function (b) {
        "[object Array]" == Object.prototype.toString.call(b) && (a.size = b[0], a.star = b[1], a.member_bonus = b[2], a.checkin_info(function () {
          a.checkin_success()
        }))
      }, function (b) {
        void 0 !== b.error_code && "C1" == b.error_code ? a.checkin_info(function () {
          a.checkin_show()
        }) : void 0 !== b.error_code && "C-1" == b.error_code
      })
    },
    checkin_success: function () {
      var a = this,
        b = (c.format.formatsize(1024 * a.quota * 1024, 2), "");
      b = a.member_bonus ? '<img src="' + STATIC_URL + 'images/wapImg/reg_mem.png" width="160">' : '<img src="' + STATIC_URL + 'images/wapImg/reg_mem_no.png" width="160">';
      for (var d = "", e = 1; e <= a.star; e++) d += '<span class="star"></span>';
      for (var e = a.star + 1; 5 >= e; e++) d += '<span class="star star_gray"></span>';
      var f = '<section class="reg_wrap" id="checkin_spaceblock">							<div class="pic">' + b + '</div>						    <p class="space">获得' + a.size + '微盘空间</p>						    <div class="luck"><span class="txt">好运指数</span>' + d + '</div>						    <p class="mem_txt">会员尊享签到空间 X2</p>						    <div class="btn clearfix"><a id="checkin_confirm" class="reg_btn left">确定</a><a id="checkin_sentweibo" class="reg_btn right">发微博再送50M</a></div>						</section>';
      $(".header").after(f), a.update_total_quota(), $("#checkin_spaceblock").on("click", "#checkin_confirm", function () {
        a.checkin_show(), $("#checkin_spaceblock").remove()
      }), $("#checkin_spaceblock").on("click", "#checkin_sentweibo", function () {
        a.checkin_sentweibo(), $("#checkin_spaceblock").remove()
      })
    },
    checkin_show: function () {
      var a = this,
        b = a.size + a.sentweibo_size,
        c = "签到获得" + b + "M";
      $(".sign_wrap").hide(), $(".sign_tips").html(c).show()
    },
    checkin_sentweibo: function () {
      var a = this,
        b = "我今天在#微盘签到#获得了" + a.size + "M免费空间，好运指数" + a.star + "颗星，你也来试试手气吧~@微盘 新浪网旗下云存储品牌，超大存储空间，海量资源下载，手机电脑数据任你同步，微力无限，快来体验吧！http://vdisk.weibo.com/wap/";
      c.api({
        url: "api/weipan/2/checkin/checkin_send_weibo",
        type: "POST",
        data: {
          msg: b
        }
      }, function (b) {
        a.checkin_sentweibo_success(b)
      }, function (b) {
        $("#checkin_spaceblock").remove(), a.checkin_show()
      })
    },
    checkin_sentweibo_success: function (a) {
      var b = this;
      this.sentweibo_size = a;
      var c = this.size + a,
        d = '<div class="send_ok"><p>发布成功!今天共获得' + c + "M空间~</p></div>";
      $(".header").after(d), this.checkin_show(), this.checkin_info(function () {
        b.update_total_quota()
      })
    },
    update_total_quota: function () {
      var a = c.format.formatsize(1024 * this.quota * 1024, 2);
      $("#space_quota").html(a)
    },
    bind: function () {
      var a = this;
      $(".sign_btn").bind("click", function () {
        return 1 == $(this).data("status") ? !1 : ($(this).addClass("sign_btn_on").data("status", !0), void a.checkin())
      })
    }
  };
  $("#login_btn").length || i.init()
});

if (define("2/vdisk", ["2/cmdlib/vui", "2/core"], function (require) {
    var a = require("2/cmdlib/vui"),
      b = require("2/core");
    vdisk.version = "1.2";
    vdisk.init = function () {
      vdisk.topSearch.init(), vdisk.common.backToTop(), vdisk.advertise.init(), vdisk.getQr(), vdisk.fixTitle.init(), vdisk.tollbarFixed(), vdisk.friendsShareStatus(), !uid && -1 != window.location.href.indexOf("retcode=6102")
    }, vdisk.delayLoad = function () {
      uid && (vdisk.myVdisk(), setInterval("vdisk.myVdisk()", 3e5)), vdisk.noviceTask.init(), vdisk.slideshowRecommend.init(), vdisk.capacityNoviceStatus.init(), vdisk.showTopshare.init(), vdisk.like_for_user.init(), vdisk.right_navigation.init(), uid && vdisk.feedNum.init();
      var a = ("https:" == document.location.protocol ? "https://" : "http://") + "js.t.sinajs.cn/open/analytics/js/suda.js";
      seajs.use(a);
      var b = (("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js", b || []);
      b.push(["_setAccount", "UA-28230033-1"]), b.push(["_trackPageview"]), vdisk.fixIE6Layer()
    }, vdisk.fixIE6Layer = function () {
      $(function () {
        function a() {
          if (20 >= c) {
            var b = $(".W_outFrame[node-type=outer]");
            if (b.length && 10009 != b.css("zIndex")) {
              if (b.css("zIndex", 10009), c = 0, c = 0, !window.XMLHttpRequest && $(".W_outFrame .W_layer .content").length) {
                var d = $(".W_outFrame .W_layer .content").width();
                $(".W_outFrame .W_layer").css("width", d), b.css("left", ($(window).width() - d) / 2)
              }
            } else c++, setTimeout(a, 100)
          }
        }

        function b() {
          var c = $("#weibo_top_public a[node-type=loginBtn]");
          c.length ? c.on("click", function () {
            a()
          }) : setTimeout(function () {
            b()
          }, 1e3)
        }
        var c = 0;
        b()
      })
    }, vdisk.friendsShareStatus = function () {
      $("#mfriendsShare").length && b.api({
        url: "api/weipan/2/sharefriend/list_items",
        data: {
          page: 1,
          page_size: 1,
          read: "false",
          need_total: "true"
        }
      }, function (a) {
        "undefined" != typeof a.unreaded && a.unreaded > 0 && $("#mfriendsShare").removeClass("friend_share_icon").addClass("friend_share_icon_n")
      })
    }, vdisk.getQr = function () {
      var a = "/share/getQr?url=http://" + CURRENT_URL,
        b = '<img src="' + a + '" width="130"/>';
      $("#qr").bind("mouseover", function () {
        $("#qrcode").append(b), $("#qrlayer").show()
      }), $("#qr").bind("mouseout", function () {
        $("#qrcode img").remove(), $("#qrlayer").hide()
      })
    }, vdisk.checkLogin = function (a) {
      return "object" == typeof a && "undefined" != typeof a.errcode && "401" == a.errcode ? (vdisk.login(), !1) : !0
    }, vdisk.getEerrorCode = function (a) {
      var b = null;
      return a.err_code ? b = a.err_code : a.errcode && (b = a.err_code), void 0 == b && (b = 0), b
    }, vdisk.checkResponse = function (a) {
      return !("no login" == a || "invalid source" == a)
    }, vdisk.login = function () {
      function a() {
        if (20 >= b) {
          var c = $(".W_layer[node-type=outer]");
          c.length && 10020 != c.css("zIndex") ? (c.css("zIndex", 10020), b = 0) : (b++, setTimeout(a, 100))
        }
      }
      if ("undefined" != typeof WBtopPublic && "function" == typeof WBtopPublic.showLoginLayer) {
        WBtopPublic.showLoginLayer();
        var b = 0;
        a()
      } else window.location.href = "/login"
    }, String.prototype.trim || (String.prototype.trim = function () {
      return this.replace(/^\s+|\s+$/g, "")
    }), String.prototype.trimChinese = function () {
      return this.replace(/^(\s|　)+|(\s|　)+$/g, "")
    }, vdisk.array_last = function (a) {
      return a[a.length - 1]
    }, vdisk.array_last2 = function (a) {
      return a[a.length - 2]
    }, vdisk.array_index = function (a, b, c) {
      for (var d = c || 0, e = a.length; e > d; d++)
        if (a[d] === b) return d;
      return -1
    }, vdisk.fixTitle = {
      title: document.title,
      init: function () {
        $.browser.msie && $("body").on("mouseup mousedown", function () {
          document.title = vdisk.fixTitle.title
        })
      },
      reset: function () {
        $.browser.msie && (document.title = vdisk.fixTitle.title)
      }
    }, vdisk.report = {
      link: null,
      uid: null,
      filename: null,
      show: function (a, b, c) {
        this.link = a, this.uid = b, this.filename = c;
        var d = '                <div id="report_badFile" class="W_layer">                    <div class="bg"><table><tbody><tr><td>                    <div class="content">                        <div class="title">举报不良信息</div>                        <a class="W_close" onclick="vdisk.report.destory();"></a>                        <div class="detail">                            <div class="report_layer">                                <div>                                    <p>如果此文件(夹)包含色情、暴力、侵权、广告等内容，请告诉我们，我们会及时处理。</p>                                    <p class="report_name W_texta">你要举报的文件(夹)是：<span id="report_badFile_name">' + this.filename + '</span></p>                                    <p class="W_texta">                                        <label><input id="report_badFile_author" type="checkbox" class="report_check"/> 我是文件(夹)版权人</label>                                    </p>                                    <p>（如果您是文件(夹)版权所有者，请告知我们，我们将协调发布者予以处理。)</p>                                    <div class="report_content">                                        <p class="W_texta">你可以填写更多举报说明：</p>                                        <p>                                            <textarea onclick="this.select();" id="report_badFile_info" class="textarea report_textarea" maxlength="300">是广告、色情、暴力还是虚假信息？</textarea>                                        </p>                                    </div>                                    <div class="report_btn clearfix">                                        <div class="fl">请放心，你的隐私将会得到保护。</div>                                        <div class="fr">                                            <a onclick="vdisk.report.submit();" class="W_btn_a report_submit"><span style="color:black;">确认举报</span></a> <a onclick="vdisk.report.destory();" class="W_btn_a"><span style="color:black;">取消</span></a> </div>                                    </div>                                </div>                            </div>                        </div>                    </td></tr></tbody></table></div>                </div>            ';
        $.blockUI({
          message: d
        })
      },
      submit: function () {
        var a, b = $("#report_badFile_info").val();
        if (1 == $("#report_badFile_author").prop("checked")) {
          if (!UID) return vdisk.login(), !1;
          a = 1
        } else a = 0;
        if ("" == $.trim(b) && (b = "举报文件"), this.link instanceof Array)
          for (i = 0; i < this.link.length; i++) vdisk.api.reportFile(this.link[i], this.uid, this.filename, b, a);
        else vdisk.api.reportFile(this.link, this.uid, this.filename, b, a);
        $(".save_same").attr("disabled", !1), $(".down_same").attr("disabled", !1)
      },
      destory: function () {
        $.unblockUI()
      }
    }, vdisk.myVdisk = function () {
      $("#vdisk_capacity").length && $.ajax({
        url: "/index/vidskCpacity",
        dataType: "json",
        cache: !1,
        success: function (a) {
          if (vdisk.checkLogin(a)) {
            var b = a.quota_percent_format + "%",
              c = parseInt(a.quota_total_GB, 10),
              d = a.get_novice_quota,
              e = 120,
              f = 178,
              g = 20,
              h = g - d;
            c > g ? 0 == h && (e = f) : e = Math.round(c / (h + c) * f), e = 30 > e ? 30 : e, e += "px";
            var i = '<div class="capacity_body" style="width:' + e + ';cursor:pointer;" title="已使用' + a.quota_used + ", " + b + '">                                        <div class="capacity_all" id="vdisk_capacity_total">' + a.quota_total + '</div>                                        <div class="capacity_used" id="vdisk_capacity_used" style="width:' + b + ';"></div>                                    </div>';
            if ($("#vdisk_capacity").data("get_quota", d).html(i).show(), $("#myvd_size_view").length) {
              var j = a.quota_total,
                k = "已使用" + a.quota_used + "，共" + a.quota_total,
                l = 0,
                m = 449,
                n = 674,
                h = g - d;
              c > g ? 0 == h && (m = n) : m = Math.round(c / (h + c) * n), l = m - 8, l += "px", m += "px", $(".myvd_achieved_txt").html(j), $(".myvd_size_foot_num").html(k), $(".myvd_size_box_inner").css("width", m), $(".myvd_achieved_main").css("width", l), $(".myvd_achieved_detail").css("width", b), $("#myvd_size_view").show()
            }
          }
        }
      })
    }, vdisk.atteVdisk = function () {
      var a = "/share/atteVdisk";
      $.ajax({
        url: a,
        type: "POST",
        async: !1,
        success: function (a) {
          vdisk.checkLogin(a) && ("-1" == a ? vdisk.common.tips("error", "您已经关注过@微盘!") : vdisk.common.tips("success", "关注成功!"))
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0010")
        }
      })
    }, vdisk.lazyload = {
      checkin: function () {
        seajs.use("2/page/checkin", function (a) {
          vdisk.checkin.checkin()
        })
      },
      upload: function (a) {
        null == a && (a = 0), seajs.use("vdisk/upload", function (b) {
          vdisk.upload.init(a)
        })
      },
      atteVdisk: function () {
        seajs.use("vdisk/task", function (a) {
          vdisk.task.atteVdisk.atteVdisk()
        })
      }
    }, vdisk.pages = {
      base: {
        defaultConfigs: {
          source: null,
          container: null,
          pageContainer: null,
          pagerContainer: null,
          loadingIcon: !0,
          singleRequest: !1,
          requestParams: {
            cache: !1,
            dataType: "json",
            error: function (a) {
              vdisk.checkResponse(a.responseText) ? 0 != a.status : vdisk.login(), $("#pageLoading").fadeOut()
            }
          },
          defaultParams: {}
        },
        mergeParam: function (a) {
          "object" == typeof a && $.extend(this.params, a)
        },
        setParam: function (a, b) {
          "undefined" != typeof b ? this.params[a] = b : "undefined" == typeof a ? this.params = this.configs.defaultParams : this.params = a
        },
        switchParam: function (a, b) {
          "undefined" != typeof b ? (param = {}, param[a] = b) : param = a;
          var c = !1;
          for (k in param) param[k] != this.params[k] && (c = !0);
          "undefined" != typeof this.params.page && delete this.params.page, this.mergeParam(param), this.load(this.params)
        },
        init: function (a, b) {
          var c = $.extend({}, this);
          return c.configs = $.extend({}, this.defaultConfigs, a), c.params = {}, c.render = b, c
        },
        refresh: function () {
          return this.load(this.params)
        },
        load: function (a) {
          this.setParam(a);
          var b = this.configs.requestParams,
            c = this;
          b.url = this.configs.source, b.success = function (a) {
            if (vdisk.checkLogin(a)) {
              c.render && c.render.call(c, a), "object" == typeof a && null != a && "undefined" != typeof a.pageinfo && null != c.configs.pagerContainer && c.renderPager(a.pageinfo), c.configs.loadingIcon ? $("#pageLoading").fadeOut() : $("#vdiskLoading").fadeOut(), vdisk.widgets.userinfo(c.params.userid)
            }
          }, b.data = this.params, c.configs.loadingIcon ? $("#pageLoading").show() : $("#vdiskLoading").show(), b.url ? (this.configs.singleRequest && "undefined" != typeof this.xhr && this.xhr.abort(), this.xhr = $.ajax(b)) : b.success.call()
        },
        renderPager: function (a) {
          function b(b) {
            return b == a.page ? "<span>" + b + "</span>" : '<a rel="' + b + '">' + b + "</a>"
          }
          if ("undefined" != typeof a.page_size && (a.rsTotal = a.total, a.pageSize = a.page_size, a.pageTotal = a.page_total), a.pageTotal <= 1) $(this.configs.pagerContainer).empty();
          else {
            var c = 5,
              d = 2,
              e = 2;
            a.pageTotal < c + 2 ? (d = 2, e = a.pageTotal - 1) : a.page >= a.pageTotal - c ? (d = a.pageTotal - c, e = a.pageTotal - 1) : (d = Math.max(2, a.page - Math.floor(c / 2)), e = Math.min(a.pageTotal - 1, d + c - 1));
            var f = '<div class="vd_page">';
            a.page > 1 && (f += '<a class="vd_bt_v2 vd_page_btn" rel="' + (a.page - 1) + '">上一页</a>'), f += b(1), d > 2 && (f += "<span>...</span>");
            for (var g = d; e >= g; g++) f += b(g);
            e < a.pageTotal - 1 && (f += "<span>...</span>"), f += b(a.pageTotal), a.page < a.pageTotal && (f += '<a class="vd_bt_v2 vd_page_btn" rel="' + (a.page + 1) + '"><span>下一页</span></a>'), f += "</div>", $(this.configs.pagerContainer).html(f);
            var h = this;
            $(this.configs.pagerContainer).find("[rel]").click(function () {
              vdisk.common.goToTop(), h.switchParam("page", $(this).attr("rel"))
            })
          }
        }
      }
    }, vdisk.widgets = {
      followBtn: {
        init: function (a, b, c) {
          if (uid) {
            var d = vdisk.api.friendShip(a);
            2 == d.length && d[0] ? $(b).html(vdisk.widgets.followBtn.formatFollowed()) : ($(b).html(vdisk.widgets.followBtn.formatUnfollowed(a)), $(b + " a:first").click(function () {
              return uid ? void(vdisk.api.addFriend(a) && ($(b).html(vdisk.widgets.followBtn.formatFollowed()), void 0 != c && $(b).append(c))) : void vdisk.login()
            }))
          } else $(b).html(vdisk.widgets.followBtn.formatUnfollowed());
          void 0 != c && $(b).append(c)
        },
        formatFollowed: function () {
          return '                    <span class="W_addbtn_even" title="已关注">                    <img src="' + staticUrl + 'images/common/transparent.gif" class="icon_add addbtn_d">已关注</span>                '
        },
        formatUnfollowed: function (a) {
          return '                        <a href="javascript:;" onclick="vdisk.profile.addFriend(' + a + ')" class="W_btn_b private_link">                            <span><img src="' + staticUrl + 'images/common/transparent.gif" class="icon_add addbtn_b">加关注</span>                        </a>                '
        }
      },
      userinfo: function (a) {
        if (void 0 == a || 0 == a || a == uid) uid && ($("#page_share_fd_title").html("关注人"), $("#oneInfo_box").hide(), $("#myInfo_box").show());
        else {
          var b = vdisk.api.getUserInfo(a);
          $("#page_share_fd_title").html(b.name);
          var c = b.screen_name;
          b.verified && (c += '<img class="approve" alt="新浪认证" title="新浪认证" src="' + staticUrl + 'images/common/transparent.gif" />'), $("#oneInfo_box .oneInfo_box_weibourl").attr("href", "http://weibo.com/" + b.id), $("#oneInfo_box .oneInfo_box_photourl").attr("src", b.profile_image_url), $("#oneInfo_box .oneInfo_box_weibourl2").html(c), $("#oneInfo_box .oneInfo_box_weibourl2").attr("href", "http://weibo.com/" + b.id), $("#oneInfo_box .oneInfo_box_local").html(b.location);
          var d = "http://weibo.com/" + b.id + "/";
          if ($("#oneInfo_box .oneInfo_box_gzurl strong").html(b.friends_count), $("#oneInfo_box .oneInfo_box_gzurl").attr("href", d + "follow"), $("#oneInfo_box .oneInfo_box_fsurl strong").html(b.followers_count), $("#oneInfo_box .oneInfo_box_fsurl").attr("href", d + "fans"), $("#oneInfo_box .oneInfo_box_wburl strong").html(b.statuses_count), $("#oneInfo_box .oneInfo_box_wburl").attr("href", "http://weibo.com/" + b.id), $("#myInfo_box").hide(), $("#oneInfo_box").show(), uid) {
            var e = vdisk.api.friendShip(a);
            $("#profile_friendship_container").html(2 == e.length && e[0] ? '                            <div class="W_addbtn_even" title="已关注">                                <img src="' + staticUrl + 'images/common/transparent.gif" class="icon_add addbtn_d">已关注</div>                        ' : '                            <div class="handle_btn">                                <a href="javascript:;" onclick="vdisk.profile.addFriend(' + a + ')" class="W_btn_b">                                    <span style="font-size:12px;"><img src="' + staticUrl + 'images/common/transparent.gif" class="icon_add addbtn_b">加关注</span>                                </a>                            </div>                        ')
          }
        }
      }
    }, vdisk.profile = {
      addFriend: function (a) {
        return uid ? void(vdisk.api.addFriend(a) && $("#profile_friendship_container").html('                <div class="W_addbtn_even" title="已关注">                    <img src="' + staticUrl + 'images/common/transparent.gif" class="icon_add addbtn_d">已关注</div>                ')) : void vdisk.login()
      }
    }, vdisk.system = {
      id: {
        isYun: 1,
        isPm: 3,
        isBook: 4,
        isMicroPhoto: 5,
        isBlogPhoto: 6
      },
      fileName: {
        isIntroduceFile: "欢迎使用新浪微盘.pdf"
      },
      check: function (a) {
        var b = !1,
          c = [],
          d = this.id;
        for (var e in d) "function" != typeof d[e] && c.push(d[e]);
        for (var f = 0; f < c.length; f++) a == c[f] && (b = !0);
        return b
      },
      dir: function (a) {
        var b = {};
        return a == this.id.isYun ? b.name = "新浪云 " : a == this.id.isPm && (b.name = "微博私信 "), b
      },
      defaultDirIcon: function (a, b) {
        var c = "vd_icon32_v2 vd_folder";
        switch (b && (c = "pic_v2 pic_folder_mobile"), a) {
          case "*新浪云":
            c = b ? "pic_v2 v_folder_sina" : "vd_icon32_v2 vd_folder_sina";
            break;
          case "微博私信文件":
            c = b ? "pic_v2 v_pic_yun" : "vd_icon32_v2 vd_yun";
            break;
          case "阅读收藏":
            c = b ? "pic_v2 v_folder_book" : "vd_icon32_v2 vd_book_collection";
            break;
          case "微相册":
            c = b ? "pic_v2 v_folder_photo" : "vd_icon32_v2 vd_photo";
            break;
          case "博客图片":
            c = b ? "pic_v2 blog_folder_photo" : "vd_icon32_v2 vd_blog";
            break;
          case "图片":
            c = b ? "pic_v2 pic_folder_picture" : "vd_icon32_v2 vd_folder_picture";
            break;
          case "文档":
            c = b ? "pic_v2 pic_folder_page" : "vd_icon32_v2 vd_folder_page";
            break;
          case "手机备份":
            c = b ? "pic_v2 pic_folder_mobile" : "vd_icon32_v2 vd_folder_mobile"
        }
        return c
      },
      pm: {
        deleteMsg: "删除后你将无法在私信中查看此附件,确定删除吗?"
      }
    }, vdisk.virusScanSet = function (a, b) {
      var c = [];
      return a ? b ? (c[0] = " (已检测)", c[1] = "virus_scan_safe") : (c[0] = " (可能存在风险)", c[1] = "virus_scan_dangerous") : (c[0] = " (未杀毒)", c[1] = "virus_scan_none"), c
    }, vdisk.virusScan = function () {
      $(".virus_scan_safe").hover(function () {
        $(this).append('<div class="layer_pop">已通过杀毒软件ClamAV检测<span class="arrow_top"></span></div>')
      }, function () {
        $(".layer_pop", this).remove()
      }), $(".virus_scan_dangerous").hover(function () {
        $(this).append('<div class="layer_pop">未通过杀毒软件ClamAV检测<span class="arrow_top"></span></div>')
      }, function () {
        $(".layer_pop", this).remove()
      }), $(".virus_scan_none").hover(function () {
        $(this).append('<div class="layer_pop">暂未进行安全检测<span class="arrow_top"></span></div>')
      }, function () {
        $(".layer_pop", this).remove()
      })
    }, vdisk.tree = {
      dirTreeViewer: function (a, b, c) {
        "undefined" == typeof c && (c = !0);
        var d = "";
        return c && (d += vdisk.tree.formatDir(a, {
          id: 0,
          name: "我的微盘"
        })), d += '<div class="main_tree" id="tree-' + a + '"><input type="hidden" id="tree-' + a + '-active-id" value="' + b + '" />', d += "</div>"
      },
      locateAndActiveDir: function (a, b) {
        if ("undefined" != typeof b) {
          var c = b.slice();
          0 != c[0] && c.unshift(0);
          for (var d = 0; d < c.length; d++) vdisk.tree.showChildDir(a, c[d]), this.toggleArrow(a, c[d]);
          vdisk.tree.setActiveDirId(a, vdisk.array_last(c))
        }
      },
      toggleChildDir: function (a, b) {
        var c = $("#tree-" + a + "-" + b + "-children");
        0 == c.length ? vdisk.tree.showChildDir(a, b) : c.children().length && c.toggle(), this.toggleArrow(a, b)
      },
      toggleArrow: function (a, b) {
        if (b) {
          var c, d = $("#tree-" + a + "-" + b + "-children");
          c = 0 == d.length || 0 == d.children().length ? "none" : d.is(":visible") ? "down" : "up", $("#tree-" + a + "-" + b + " span:first").attr("class", "arrow_layer_" + c)
        }
      },
      showChildDir: function (a, b) {
        var c = $("#tree-" + a + "-" + b + "-children");
        0 == c.length ? vdisk.tree.loadChildDir(a, b) : c.children().length && c.show()
      },
      hideChildDir: function (a, b) {
        var c = $("#tree-" + a + "-" + b + "-children");
        c.hide()
      },
      loadChildDir: function (a, b) {
        var c = !1;
        return $.ajax({
          url: "/dir/ajaxListItems",
          cache: !1,
          data: {
            include_item: "folder",
            page_size: 100,
            dir_id: b
          },
          dataType: "json",
          async: !1,
          success: function (d) {
            if (vdisk.checkLogin(d)) {
              var e = "";
              "undefined" != typeof d.data && $.each(d.data, function (b, c) {
                "undefined" == typeof c.pid || vdisk.system.check(c.id) || (e += vdisk.tree.formatDir(a, c))
              }), $children = $("#tree-" + a + "-" + b + "-children"), 0 != $children.length ? ($children.html(e), "" == e && $children.hide()) : (e = '<div id="tree-' + a + "-" + b + '-children" class="fld_ln"' + ("" == e ? ' style="display:none;" ' : "") + ">" + e + "</div>", 0 != b ? $("#tree-" + a + "-" + b).append(e) : $("#tree-" + a).append(e)), c = !0
            }
          },
          error: function () {}
        }), c
      },
      formatDir: function (a, b) {
        if (0 == b.id) return '                    <div class="fld_ln" id="tree-' + a + "-" + b.id + '">                        <img src="' + staticUrl + 'images/vdisk/main_tree_title_logo.png" align="absmiddle" />&nbsp;<a onclick="vdisk.tree.dirclick(\'' + a + "', " + b.id + ');" title="' + vdisk.common.HTMLFilter(b.name) + '"><span id="tree-' + a + "-" + b.id + '-name">' + vdisk.common.HTMLFilter(b.name) + "</span></a>                    </div>                ";
        var c = "none";
        return b.dir_num > 0 && (c = "up"), '                    <div class="fld_ln" id="tree-' + a + "-" + b.id + '">                        <span class="arrow_layer_' + c + '" onclick="vdisk.tree.dirclick(\'' + a + "', " + b.id + ');"></span><img src="' + staticUrl + 'images/vdisk_v2/file_layer.png" width="20" height="13" align="absmiddle"><a onclick="vdisk.tree.dirclick(\'' + a + "', " + b.id + ');" title="' + vdisk.common.HTMLFilter(b.name) + '"><span id="tree-' + a + "-" + b.id + '-name">' + vdisk.common.HTMLFilter(b.name) + "</span></a>                    </div>                "
      },
      dirclick: function (a, b) {
        vdisk.tree.toggleChildDir(a, b), vdisk.tree.setActiveDirId(a, b)
      },
      getActiveDirId: function (a) {
        return parseInt($("#tree-" + a + "-active-id").val())
      },
      setActiveDirId: function (a, b) {
        var c = $("#tree-" + a + "-active-id"),
          d = c.val();
        $("#tree-" + a + "-" + d + "-name").removeClass("on");
        var e = $("#tree-" + a + "-" + b + "-name");
        0 == e.length && (b = 0, e = $("#tree-" + a + "-" + b + "-name")), $("#tree-" + a + "-" + b + "-name").addClass("on"), c.val(b)
      },
      dirCreator: function (a) {
        return '                <span id="tree-' + a + '-dircreator" style="display:inline-block;width:250px;text-align:right;_margin-right:-23px">                    <a id="tree-' + a + '-new-dir-button" onclick="vdisk.tree.showNewDirForm(\'' + a + '\')" style="float:right;_margin-right:23px"><img src="' + staticUrl + 'images/vdisk/plus.png" /> 新建文件夹</a>                    <input type="text" class="inp" id="tree-' + a + '-new-dir-name" style="width:120px;height:12px;float:left;display:none;" />                    <a class="W_btn_b" id="tree-' + a + '-new-dir-submit" style="float:left;margin-left:3px;display:none;" onclick="vdisk.tree.submitNewDirForm(\'' + a + '\')" href="javascript:;"><span>创建</span></a>                    <a class="W_btn_a" id="tree-' + a + '-new-dir-cancel" style="float:left;margin-left:3px;display:none;" onclick="vdisk.tree.hideNewDirForm(\'' + a + '\')" href="javascript:;"><span>取消</span></a>                </span>            '
      },
      showNewDirForm: function (a) {
        $("#tree-" + a + "-dircreator").children().toggle(), $("#tree-" + a + "-save-new-dir-name").focus()
      },
      hideNewDirForm: function (a) {
        $("#tree-" + a + "-dircreator").children().toggle()
      },
      submitNewDirForm: function (a) {
        var b = $("#tree-" + a + "-new-dir-name"),
          c = vdisk.tree.getActiveDirId(a),
          d = b.val();
        return d.length <= 0 ? void vdisk.tips.popupTitle("目录名不能为空") : vdisk.common.getLength(d) > 100 ? void vdisk.tips.popupTitle("目录名长度不能超过100个字符!") : vdisk.common.fileNameCheck(d) ? void(0 != d.length && $.ajax({
          url: "/dir/create",
          async: !1,
          dataType: "json",
          type: "POST",
          data: {
            dir_id: c,
            name: d
          },
          success: function (d) {
            if (vdisk.checkLogin(d)) {
              var e = d.err_code;
              if (e) switch (e) {
                case 3:
                  vdisk.tips.popupTitle("请使用有效的目录路径");
                  break;
                case 4:
                  vdisk.tips.popupTitle("文件夹名已存在");
                  break;
                case 5:
                  vdisk.tips.popupTitle("系统错误，请稍后再试");
                  break;
                case 6:
                  vdisk.tips.popupTitle("文件夹名已存在");
                  break;
                case 7:
                  vdisk.tips.popupTitle("微盘空间不足 ");
                  break;
                case 101:
                  vdisk.tips.popupTitle("超过上传文件大小");
                  break;
                case 102:
                  vdisk.tips.popupTitle("超过上传文件大小");
                  break;
                case 104:
                  vdisk.tips.popupTitle("上传失败，请重试");
                  break;
                case 601:
                  vdisk.tips.popupTitle("文件夹已满");
                  break;
                case 611:
                  vdisk.tips.popupTitle("系统目录暂不支持创建子目录");
                  break;
                case 702:
                  vdisk.tips.popupTitle("操作错误，请重试");
                  break;
                case 900:
                  vdisk.tips.popupTitle("超出了请求限制");
                  break;
                default:
                  vdisk.tips.popupTitle("操作出错。")
              } else b.val(""), vdisk.tree.loadChildDir(a, c), vdisk.tree.showChildDir(a, c), vdisk.tree.toggleArrow(a, c), vdisk.tree.hideNewDirForm(a)
            }
          },
          error: function () {
            vdisk.tips.popupTitle("网络错误，请稍后重试")
          }
        })) : void vdisk.tips.popupTitle('目录名不能包含下列任何字符: /:*?"<>|')
      }
    }, vdisk.settings = {
      getAll: function (a) {
        "undefined" == typeof a && (a = !1);
        var b = !1;
        return (a || null === (b = vdisk.cache.get("settings"))) && $.ajax({
          url: "/usersettings/getUserSettings",
          dataType: "json",
          cache: !1,
          async: !1,
          success: function (a) {
            vdisk.checkLogin(a) && ("object" == typeof a ? (vdisk.cache.set("settings", a), b = a) : b = !1)
          }
        }), b
      },
      getByKey: function (a, b) {
        var c = vdisk.settings.getAll(b);
        return "undefined" != typeof c[a] ? c[a] : null
      }
    }, vdisk.notice = {
      test: function () {
        this.register({
          type: 6,
          concurrent: !1,
          callback: vdisk.filemanager.notice.guide.show
        }), this.register({
          type: 7,
          concurrent: !1,
          callback: function () {
            alert("bb")
          }
        }), this.handle()
      },
      handlers: {},
      register: function (a) {
        a = $.extend({
          priority: 100,
          concurrent: !0,
          once: !0
        }, a), this.handlers[a.type] = a
      },
      _getSortedTypes: function () {
        var a = [],
          b = [];
        $.each(this.handlers, function (a, c) {
          b.push(c)
        }), b.sort(function (a, b) {
          return a.priority - b.priority
        });
        for (var c = 0; c < b.length; c++)
          for (var d = 0; d < this.data.length; d++) b[c].type == this.data[d].type && a.push(b[c].type);
        return a
      },
      handle: function () {
        var a = this;
        this.getUnread(function () {
          for (var b = a._getSortedTypes(), c = !1, d = 0; d < b.length; d++) {
            var e = a.handlers[b[d]];
            e.concurrent ? a._handleOne(e.type) : c || a._handleOne(e.type) && (c = !0)
          }
        })
      },
      _handleOne: function (a) {
        var b = this.handlers[a];
        return b.once && 1 != vdisk.counter.inc("notice.type." + a) ? !1 : (b.callback.call(), !0)
      },
      types: {
        FEATURE_PRIVATE: 4,
        FEATURE_FILETYPE_FILTER: 5,
        NOTICE_TYPE_USER_GUIDE: 6,
        NOTICE_TYPE_NOVICE_TASK: 7,
        RIGHT_NOVICE_TASK_STAT: 81,
        NOTICE_TYPE_ALBUM_UPLOAD: 9,
        NOTICE_TYPE_FRIEND_SHARE: 10
      },
      data: null,
      getUnread: function (a) {
        null == this.data ? $.ajax({
          url: "/usernotice/ajaxGetUnread",
          dataType: "json",
          cache: !1,
          success: function (b) {
            vdisk.checkLogin(b) && 0 == b.errcode && (vdisk.notice.data = b.data, "undefined" != typeof a && a.call())
          }
        }) : "undefined" != typeof a && a.call()
      },
      checkIsUnreadByType: function (a, b) {
        this.getUnread(function () {
          for (var c = 0; c < vdisk.notice.data.length; c++)
            if (vdisk.notice.data[c].type == a) {
              b.call(null, vdisk.notice.data[c]);
              break
            }
        })
      },
      receiveByType: function (a, b) {
        this.receiveByTypeApi(a, function (c) {
          0 == c.errcode && (vdisk.notice.removeTypeFromCache(a), "undefined" != typeof b && b.call())
        })
      },
      removeTypeFromCache: function (a) {
        if (null != this.data)
          for (var b = 0; b < this.data.length; b++)
            if (this.data[b].type == a) {
              this.data.splice(b, 1);
              break
            }
      },
      receiveByTypeApi: function (a, b) {
        $.ajax({
          url: "/usernotice/ajaxReceiveNoticeByType",
          type: "POST",
          data: {
            type: a
          },
          dataType: "json",
          success: b
        })
      }
    }, vdisk.tips = {
      popupTitle: function (a) {
        $title = $(".W_layer:visible .title"), $tip = $title.find("div"), 0 == $tip.length ? $title.prepend('<div style="float:right;padding-right:30px;width:220px;height:28px;overflow:hidden;text-align:right;font-size:12px;color:orange;">' + a + "</div>") : $tip.html(a), setTimeout(function () {
          $title.find("div").remove()
        }, 3e3)
      }
    }, vdisk.search = function () {
      $("#leftNav_Search button").click(function () {
        var a = $("#leftNav_Search input").val();
        "搜索..." == a || "" == a || window.open("http://s.weibo.com/weibo/" + encodeURIComponent(a + " 微盘") + "&Refer=STopic_orig")
      }), $("#leftNav_Search input").click(function () {
        "搜索..." == $("#leftNav_Search input").val() && $("#leftNav_Search input").val("")
      }), $("#leftNav_Search input").bind("keydown", "return", function () {
        $("#leftNav_Search button").click()
      })
    }, vdisk.topSearch = {
      init: function () {
        $("#search_keyword").length && (a.defaultchars("#search_keyword"), $("#search_form").submit(function () {
          var a = $("#search_keyword"),
            b = a.val().trim();
          return "f" == a.attr("needsubmit") ? !1 : "" == b || "搜索大家共享的文件" == b ? (vdisk.common.tips("error", "请输入搜索关键词"), !1) : !0
        }), $("#search_keyword").val().trim() || a.defaultchars("#search_keyword"))
      },
      switchTo: function (a) {}
    }, vdisk.searchMyVdisk = {
      init: function () {
        a.defaultchars("#vd_search_my"), $("#vd_search_my").focus(function () {
          $(".search_inp").toggleClass("search_inp_focus", !0)
        }), $("#vd_search_my").blur(function () {
          $(".search_inp").toggleClass("search_inp_focus", !1)
        })
      },
      checkForm: function (a) {
        $form = $(a), $keyword = $form.find("[name=keyword]");
        var b = $keyword.val();
        return 0 != b.trim().length && b != $keyword.attr("defaultchars") ? !0 : (vdisk.common.tips("error", "请输入搜索关键词"), !1)
      },
      tag: !1,
      hideForm: function () {
        $(".search_my_form").hide()
      },
      showForm: function () {
        $(".search_my").click(function () {
          var b = $(this).offset().top + $(this).height(),
            c = $(this).offset().left - 8,
            d = siteurl + "search/",
            e = '                    <div class="search_my_form" style="position:absolute;top:' + b + "px;left:" + c + 'px;">                        <form action="' + d + '" method="get" onsubmit="return vdisk.searchMyVdisk.checkForm(this);">                            <input type="hidden" name="type" value="my" />                            <input type="text" maxlength="20" name="keyword" class="inp"/>                            <input type="submit" title="搜索" value="" class="sub">                        </form>                    </div>                    ';
          0 == vdisk.searchMyVdisk.tag ? ($("body").append(e), $(".search_my_form .inp").focus()) : ($(".search_my_form").show(), $(".search_my_form .inp").focus()), a.clickhide(".search_my_form")
        })
      }
    }, vdisk.tosinatNumSet = function () {
      $(".num span").html($(".share_main_textarea").val().length), $(".share_main_textarea").maxlength()
    }, vdisk.common = {
      HTMLFilter: function (a, b) {
        return "undefined" == typeof b && (b = 3), a = a.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"), (1 == b || 3 == b) && (a = a.replace(/'/g, "&#039;")), (2 == b || 3 == b) && (a = a.replace(/"/g, "&quot")), a
      },
      quote: function (a, b) {
        return "undefined" == typeof b && (b = 2), 1 == b ? a = a.replace(/'/g, "\\'") : 2 == b && (a = a.replace(/"/g, '\\"')), a
      },
      isMac: function () {
        var a = navigator.userAgent;
        return a.indexOf("Mac") > -1 ? !0 : !1
      },
      isIe6: function () {
        return !window.XMLHttpRequest
      },
      getExtensionName: function (a, b) {
        if (!a) return "";
        var c = a.split(".").length;
        if (1 == c) return "";
        var d = a.split(".")[c - 1];
        return b && (d = d.toLowerCase()), d
      },
      getFileName: function (a) {
        var b = a.lastIndexOf(".");
        return -1 == a.indexOf(".") ? a : a.substring(0, b)
      },
      fileNameCheck: function (a) {
        var b = a.match(/[\/:*?\"<>|\\]/i);
        return null == b ? !0 : !1
      },
      randomOrder: function (a) {
        for (var b = a.length, c = new Array, d = 0; b > d; d++) c[d] = d;
        for (var e = new Array, d = 0; b > d; d++) e[d] = c.splice(Math.floor(Math.random() * c.length), 1);
        for (var f = new Array, d = 0; b > d; d++) f[d] = a[e[d]];
        return f
      },
      substr: function (a, b, c) {
        if (null != a) {
          "undefined" == typeof b && (b = 18), b *= 2, "undefined" == typeof c && (c = !0);
          for (var d = 0, e = "", f = /[^\x00-\xff]/g, g = "", h = a.replace(f, "**").length, i = 0; h > i && (g = a.charAt(i).toString(), null != g.match(f) ? d += 2 : d++, !(d > b)); i++) e += g;
          return c && h > b && (e += "..."), e
        }
      },
      inputFocus: function () {
        $(".inp,.textarea").focus(function () {
          $(this).css({
            color: "#666"
          })
        }).blur(function () {})
      },
      inputTips: function (a, b, c) {
        var d = $("." + a),
          e = $("." + b),
          f = $("." + c);
        f.val(""), e.show(), d.css({
          position: "relative"
        }), e.css({
          position: "absolute",
          top: "5px",
          left: "5px"
        }), f.focus(function () {
          e.hide()
        }).blur(function () {
          "" == $(this).val() && e.show()
        }), e.click(function () {
          f.trigger("focus")
        })
      },
      forwardSet: function () {
        var a = $(".share_main_textarea");
        a.css({
          height: "55px",
          overflow: "auto"
        }), vdisk.common.inputTips("share_main_textarea_body", "share_main_textarea_tips", "share_main_textarea"), vdisk.tosinatNumSet()
      },
      AddOnPos: function (a, b) {
        var c = document.getElementById(a);
        if (document.selection) c.focus(), sel = document.selection.createRange(), sel.text = b, sel.select();
        else if (c.selectionStart || "0" == c.selectionStart) {
          var d = c.selectionStart,
            e = c.selectionEnd,
            f = c.scrollTop;
          c.value = c.value.substring(0, d) + b + c.value.substring(e, c.value.length), f > 0 && (c.scrollTop = f), c.focus(), c.selectionStart = d + b.length, c.selectionEnd = d + b.length
        } else c.value += b, c.focus()
      },
      unblockUI: function () {
        $(".W_layer .W_close").click(function () {
          return $.unblockUI(), !1
        })
      },
      capacityDetail: function () {
        var a = $(".capacity_wrap"),
          b = $(".capacity_detail");
        a.hover(function () {
          b.show()
        }, function () {
          b.hide()
        })
      },
      tips: function (b, c, d, e, f) {
        function g() {
          $.unblockUI(), a.preventScroll.destroy()
        }
        d || (d = 1500), "undefined" == typeof f && (f = 1);
        var h = "";
        "success" == b && (h = "succ"), "error" == b && (h = "error"), "timeout" == b && (h = "error", void 0 == c && (c = ""), c += " 网络出错，请重新尝试^_^");
        var i = '                <div class="W_layer">                    <div class="bg">                        <table cellspacing="0" cellpadding="0" border="0">                            <tbody>                                <tr>                                    <td><div class="content">                                            <div class="title">提示</div>                                            <a class="W_close" href="javascript:$.unblockUI()" title="关闭 (或按ESC键关闭)"></a>                                            <div class="layer_point">                                                <dl class="point clearfix">                                                    <dt><span class="icon_' + h + 'B"></span></dt>                                                    <dd>                                                        <p class="W_texta">' + c + '</p>                                                    </dd>                                                </dl>                                                <div class="btn"><a class="W_btn_a" onclick="$.unblockUI()"><span>确认</span></a></div>                                            </div>                                        </div></td>                                </tr>                            </tbody>                        </table>                    </div>                </div>            ';
        e && (i = e), $.unblockUI(), $.blockUI({
          message: i,
          css: {
            zIndex: 10010
          }
        }), d && f && setTimeout(g, d)
      },
      confirm: function (a, b, c) {
        void 0 != c ? c && (b += ";$.unblockUI();") : b += ";$.unblockUI();";
        var d = "question",
          e = '                <div class="W_layer" id="vdisk_confirm_dialog">                    <div class="bg">                        <table cellspacing="0"cellpadding="0"border="0">                            <tbody>                                <tr>                                    <td><div class="content">                                            <div class="title">提示</div>                                            <a class="W_close" href="javascript:$.unblockUI()" title="关闭"></a>                                            <div class="layer_point">                                                <dl class="point clearfix">                                                    <dt><span class="icon_' + d + 'B"></span></dt>                                                    <dd>                                                        <p class="W_texta">' + a + '</p>                                                    </dd>                                                </dl>                                                <div class="btn"><a class="W_btn_b" onclick="' + b + '"><span>确认</span></a><a class="W_btn_a" href="javascript:$.unblockUI()"><span>取消</span></a></div>                                            </div>                                        </div></td>                                </tr>                            </tbody>                        </table>                    </div>                </div>            ';
        $.blockUI({
          message: e,
          css: {
            zIndex: 10010
          }
        })
      },
      confirmWithCallback: function (a, b) {
        var c = "question",
          d = '                <div class="W_layer" id="vdisk_confirm_dialog">                    <div class="bg">                        <table cellspacing="0"cellpadding="0"border="0">                            <tbody>                                <tr>                                    <td><div class="content">                                            <div class="title">提示</div>                                            <a class="W_close" href="javascript:$.unblockUI()" title="关闭"></a>                                            <div class="layer_point">                                                <dl class="point clearfix">                                                    <dt><span class="icon_' + c + 'B"></span></dt>                                                    <dd>                                                        <p class="W_texta">' + a + '</p>                                                    </dd>                                                </dl>                                                <div class="btn"><a class="W_btn_b confirm_btn"><span>确认</span></a><a class="W_btn_a" href="javascript:$.unblockUI()"><span>取消</span></a></div>                                            </div>                                        </div></td>                                </tr>                            </tbody>                        </table>                    </div>                </div>            ';

        $.blockUI({
          message: d,
          css: {
            zIndex: 10010
          }
        }), $("#vdisk_confirm_dialog .confirm_btn").on("click", function () {
          $.unblockUI(), b()
        })
      },
      backToTop: function () {
        function a() {
          var a = "";
          a && clearTimeout(a);
          var d = $(document).scrollTop();
          if (d > 0) {
            if (d < $(document).height())
              if (c.css({
                  visibility: "visible"
                }), vdisk.common.isIe6()) {
                c.css({
                  visibility: "hidden"
                });
                var e = document.body.clientHeight && document.documentElement.clientHeight + d - 200;
                c.css({
                  top: e,
                  position: "absolute"
                }), c.css({
                  visibility: "visible"
                })
              } else c.css({
                bottom: "100px"
              })
          } else c.css({
            visibility: "hidden"
          });
          b()
        }

        function b() {
          var a = $(document).scrollTop(),
            b = 0;
          if (0 == a && (b = 100), a < $(document).height())
            if (d.css({
                visibility: "visible"
              }), vdisk.common.isIe6()) {
              d.css({
                visibility: "hidden"
              });
              var c = document.body.clientHeight && document.documentElement.clientHeight + a - 326 + b;
              d.css({
                top: c,
                position: "absolute"
              }), d.css({
                visibility: "visible"
              })
            } else d.css({
              bottom: 201 - b + "px"
            })
        } {
          var c = $(".goTop"),
            d = $(".vd_question_layer");
          document.body.clientHeight && document.documentElement.clientHeight, $(document).height()
        }
        b(), $(window).bind("scroll", a), c.click(function () {
          c.css({
            visibility: "hidden"
          }), $("html,body").scrollTop(0)
        })
      },
      shareCommentTextarea: function () {
        var a = $(".share_tosinat .ico_up_a"),
          b = $(".share_comment_textarea");
        a.toggle(function () {
          $(this).addClass("ico_down_a"), b.css({
            height: "auto",
            overflow: "auto"
          })
        }, function () {
          $(this).removeClass("ico_down_a"), b.css({
            height: "20px",
            overflow: "hidden"
          })
        })
      },
      dialog: function (a, b, c) {
        var d = document.body.clientWidth && document.documentElement.clientWidth,
          e = document.body.clientHeight && document.documentElement.clientHeight,
          f = "6.0" == $.browser.version ? $(document).width() - 21 : $(document).width(),
          g = $(document).height();
        if (!c) {
          var h = $(document.createElement("div"));
          h.attr("id", a + "Overlay"), h.css({
            position: "absolute",
            zIndex: 9998,
            left: 0,
            top: 0,
            opacity: .15,
            backgroundColor: "#000",
            width: f,
            height: g
          }).appendTo("body")
        }
        b && $(b).appendTo("body");
        var i = $("#" + a),
          j = (d - i.outerWidth()) / 2,
          k = (e - i.outerHeight()) / 2;
        i.css({
          position: "absolute",
          left: j,
          top: k,
          zIndex: 9999
        })
      },
      getLength: function (a) {
        var b = new RegExp("(http://)+(([-A-Za-z0-9]+(.[-A-Za-z0-9]+)*(.[-A-Za-z]{2,5}))|([0-9]{1,3}(.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_$.+!*(),;:@&=?/~#%]*)*", "gi"),
          c = a.length;
        if (c > 0) {
          for (var d = 41, e = 140, f = a, g = a.match(b) || [], h = 0, i = 0, c = g.length; c > i; i++) {
            var j = vdisk.common.byteLength(g[i]);
            j > d && (h += e >= j ? 21 : 21 + (j - e) / 2, f = f.replace(g[i], ""))
          }
          return Math.ceil(h + vdisk.common.byteLength(f) / 2)
        }
        return 0
      },
      byteLength: function (a) {
        if ("undefined" == typeof a) return 0;
        var b = a.match(/[^\x00-\x80]/g);
        return a.length + (b ? b.length : 0)
      },
      getGbkLength: function (a) {
        if ("string" != typeof a) return 0;
        var b = /[^\x00-\xff]/g,
          c = a.replace(b, "**").length;
        return Math.ceil(c / 2)
      },
      goToTop: function (a) {
        "undefined" == a && (a = 0), $("html,body").scrollTop(0)
      },
      setupSize: function (a, b) {
        void 0 == b && (b = 2);
        var c = ["B", "K", "M", "G", "T", "P", "E", "Z", "Y"];
        for (unitindex = 0; a > 1024;) a /= 1024, ++unitindex;
        if (a % 1 == 0) return a + " " + c[unitindex];
        var d = Math.pow(10, b);
        return "" + Math.round(a * d) / d + " " + c[unitindex]
      },
      getFileIco: function (a, b) {
        "undefined" == typeof b && (b = !0), b = b ? "_" : "";
        var a = a.toLowerCase(),
          c = a.lastIndexOf(".");
        if (-1 === c) return new Array("其他", b + "other");
        var a = a.substring(c);
        return /txt/.exec(a) ? new Array("文档", b + "txt") : /wps/.exec(a) ? new Array("文档", b + "wps") : /doc|docx/.exec(a) ? new Array("文档", b + "doc") : /pdf/.exec(a) ? new Array("文档", b + "pdf") : /pps|ppsx|ppt|pptx/.exec(a) ? new Array("文档", b + "ppt") : /xlsx|xls/.exec(a) ? new Array("文档", b + "xls") : /mov|mpeg|wav|raw|avi|mp4|3gp|m4v|rmvb|flv/.exec(a) ? new Array("视频", b + "video") : /mp3|wma|aac|ape|flac|mid|midi|wav|m4a/.exec(a) ? new Array("音乐", b + "music") : /bmp|gif|jpeg|jpg|png|tif|ico|dwg|rp|ai|raw/.exec(a) ? new Array("图片", b + "pic") : /exe|apk|ipa/.exec(a) ? new Array("程序", b + "exe") : /rar|zip|gz|bz2|tar|7z/.exec(a) ? new Array("压缩包", b + "rar") : new Array("其他", b + "other")
      },
      getFileThumbIco: function (a) {
        var a = a.toLowerCase();
        return /image/.exec(a) ? "thumbnail_ico" : ""
      },
      myDate: function (a, b) {
        var c = /^\d+$/;
        c.test(a) && (a *= 1e3);
        var d = new Date(a),
          e = new Date,
          f = d.getMinutes(),
          g = d.getHours();
        if (d.getFullYear() == e.getFullYear() && d.getMonth() + 1 == e.getMonth() + 1 && d.getDate() == e.getDate()) return 10 > f && (f = "0" + f), 10 > g && (g = "0" + g), "今天 " + g + ":" + f;
        10 > f && (f = "0" + f), 10 > g && (g = "0" + g);
        var h = "";
        b || (h = " " + g + ":" + f);
        var i = d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate() + h;
        return void 0 == a && (i = ""), i
      },
      showLoading: function () {
        $("#pageLoading").show()
      },
      hideLoading: function () {
        $("#pageLoading").fadeOut()
      }
    }, vdisk.api = {}, vdisk.connect = {
      connect: function (a, b, c, d) {
        var e = null;
        return "undefined" == typeof a.async && (a.async = "function" == typeof c), "undefined" != typeof b && null != b && (a.data = b), "function" == typeof c ? a.success = c : a.success = function (a) {
          vdisk.checkLogin(a) && (e = a)
        }, d === !1 ? a.error = null : "function" == typeof d ? a.error = d : "undefined" == typeof a.error && (a.error = vdisk.connect.error), $.ajax(a), e
      },
      error: function () {
        vdisk.common.tips("timeout", "0x0020")
      }
    }, vdisk.api.capacity = function (a, b) {
      return vdisk.connect.connect({
        url: "/index/vidskCpacity",
        dataType: "json",
        cache: !1
      }, null, a, b)
    }, vdisk.api.getUserInfo = function (a) {
      var b;
      return $.ajax({
        url: "/user/info?uid=" + a + "&rand=" + Math.random(),
        dataType: "json",
        async: !1,
        success: function (a) {
          b = "" == a ? "" : a
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0022")
        }
      }), "" != b ? b : !1
    }, vdisk.api.atteVdisk = function () {
      var a = !1;
      return $.ajax({
        url: "/share/atteVdisk",
        type: "POST",
        cache: !1,
        async: !1,
        success: function (b) {
          vdisk.checkLogin(b) && (a = !0)
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0023")
        }
      }), a
    }, vdisk.api.checkAtteVdisk = function () {
      var a = !1;
      return $.ajax({
        url: "/share/checkAtteVdisk",
        cache: !1,
        async: !1,
        success: function (b) {
          vdisk.checkLogin(b) && (a = b)
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0024")
        }
      }), a
    }, vdisk.api.reportFile = function (a, b, c, d, e) {
      $.ajax({
        url: "/share/reportFile",
        type: "POST",
        data: {
          link: a,
          uid: b,
          filename: c,
          msg: d,
          act: e
        },
        dataType: "json",
        async: !1,
        success: function (a) {
          return vdisk.checkLogin(a) ? void(0 == a.err_code ? ($.unblockUI(), vdisk.common.tips("success", "谢谢，我们会尽快处理您的举报！")) : vdisk.common.tips("error", "网络错误，请稍后重试。")) : !1
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0025")
        }
      })
    }, vdisk.api.getRankingShare = function (a, b, c) {
      return vdisk.connect.connect({
        url: "/share/ranking_share",
        error: !1
      }, {
        page: a
      }, b, c)
    }, vdisk.api.recommend_for_user = function (a, b) {
      return vdisk.connect.connect({
        url: "/file/recommend_for_user?_=" + parseInt(10 * Math.random()),
        error: !1
      }, {
        page: page
      }, a, b)
    };
    var c = new Array;
    return vdisk.api.getShareFileInfo = function (a) {
      var b = new Array;
      if (void 0 == c[a]) {
        var d;
        $.ajax({
          url: "/share/ajaxAnonFileinfo?fid=" + a,
          dataType: "json",
          cache: !1,
          async: !1,
          success: function (a) {
            if (vdisk.checkLogin(a)) {
              var c = a,
                e = a.err_code; - 1 != a.share && (d = c, e || (b[0] = a.name, b[1] = a.size, b[2] = a.share, b[3] = a.url, b[4] = a.uid, b[5] = a.virus_scan, b[6] = a.is_safe, b[7] = a.app_name))
            }
          },
          error: function () {
            vdisk.common.tips("timeout", "0x0004")
          }
        }), c[a] = d
      } else {
        var e = c[a],
          f = e.err_code;
        f || (b[0] = e.name, b[1] = e.size, b[2] = e.share, b[3] = e.url, b[4] = e.uid, b[5] = e.virus_scan, b[6] = e.is_safe, b[7] = e.app_name)
      }
      return b
    }, vdisk.api.weiboFeed = function (a, b) {
      var c;
      return void 0 == b && (b = ""), $.ajax({
        url: "/share/" + a + "?page=1&userid=" + b + "&original=0&rand=" + Math.random(),
        async: !1,
        success: function (a) {
          vdisk.checkLogin(a) && (a.length > 0 ? c = a : (vdisk.common.tips("error", "获取数据失败……"), c = ""))
        },
        error: function () {
          vdisk.common.tips("error", "分享列表获取数据失败...")
        }
      }), c
    }, vdisk.api.deleteShareCron = function (a) {
      $.ajax({
        url: "/share/deletesharecron",
        data: "id=" + a,
        type: "POST",
        async: !1,
        cache: !1,
        success: function (b) {
          vdisk.checkLogin(b) && ("ok" != b ? vdisk.common.tips("error", b) : $("#sharecron_" + a).remove())
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0028")
        }
      })
    }, vdisk.api.getFileWeiboInfo = function (a, b) {
      var c, d = "/share/fileWeibo?fid=" + a + "&ftimetmp=" + b + "&rand=" + Math.random();
      return $.ajax({
        url: d,
        async: !1,
        dataType: "json",
        success: function (a) {
          c = a.length > 0 ? a : ""
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0029")
        }
      }), c
    }, vdisk.api.getWeiboByFid = function (a) {
      var b;
      return $.ajax({
        url: "/share/weiboShare?fid=" + a + "&rand=" + Math.random(),
        async: !1,
        success: function (a) {
          b = a.length > 0 ? a : ""
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0030")
        }
      }), b
    }, vdisk.api.forwardWeiBo = function (a, b, c, d, e, f) {
      var g = vdisk.common.getLength(a);
      0 == g || g > 140 || ("undefined" == typeof d && (d = !0), $.ajax({
        url: "/share/forward",
        type: "POST",
        dataType: "json",
        data: {
          msg: a,
          id: b,
          type: c
        },
        async: !1,
        success: function (a) {
          if (vdisk.checkLogin(a)) {
            var b = a.error_code;
            if (b && 0 != b) {
              switch (a.error) {
                case "40025:Error: repeated weibo text!":
                  d && vdisk.common.tips("error", "你转发的微博中已经有一样的内容了");
                  break;
                default:
                  a.error.indexOf("40098") >= 0 ? d && vdisk.common.tips("error", "微博已经提交，请耐心等待管理员审核") : d && vdisk.common.tips("error", "转发微博出错，请重试。")
              }
              f && f(a)
            } else d && vdisk.common.tips("success", "转发微博成功。"), e && e(a)
          }
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0003")
        }
      }))
    }, vdisk.api.saveToMe = function (a, b) {
      var c = !0;
      return "undefined" == typeof b && (b = 0), $.ajax({
        url: "/file/save2me",
        type: "POST",
        dataType: "json",
        data: {
          fid: a,
          dir_id: b
        },
        success: function (a) {
          vdisk.checkLogin(a) || (c = !1);
          var b = a.err_code;
          switch (b && (c = !1), b) {
            case 0:
              vdisk.common.tips("success", "文件已保存到您的微盘"), c = !0;
              break;
            case 1:
              vdisk.common.tips("error", "该文件不存在，请检查下载地址是否正确");
              break;
            case 3:
              vdisk.common.tips("error", "哎呀，该文件已被作者删除或取消分享...");
              break;
            case 4:
              vdisk.common.tips("error", "你已经保存过此文件了，无需重新保存^_^");
              break;
            case 6:
              vdisk.common.tips("error", "别着急，微盘正在维护数据，稍后回来~");
              break;
            case 7:
              vdisk.common.tips("error", "空间不足,请申请扩容, 或者清理您的回收站");
              break;
            case 601:
              vdisk.common.tips("error", "目录已满，请选择其它目录");
              break;
            case 802:
              vdisk.common.tips("error", "哎呀，该文件已被作者删除或取消分享...");
              break;
            default:
              vdisk.common.tips("error", "保存失败")
          }
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0002")
        }
      }), c ? !0 : !1
    }, vdisk.api.downloadFile = function (a, b, c, d) {
      var e = "",
        f = "/share/ajaxFileinfo?fid=" + a + "&dl=true";
      return d && (f = "/share/ajaxAnonFileinfo?fid=" + a), $.ajax({
        url: f,
        dataType: "json",
        async: !1,
        success: function (a) {
          if (vdisk.checkLogin(a)) {
            var d = a.err_code;
            if (!d) {
              var f = a.s3_url;
              return a.uid != uid && -1 == a.share ? void("undefined" != typeof b ? vdisk.common.tips("error", b) : vdisk.common.tips("error", "哎呀，该文件已被作者删除或取消分享...")) : void(c ? e = f : (0 == $("#iframe_download").length && $("body").append('<iframe id="iframe_download" src="about:blank" style="display:none;"></iframe>'), $("#iframe_download").attr("src", f), $.unblockUI()))
            }
            switch (d) {
              case 3:
                "undefined" != typeof b ? vdisk.common.tips("error", b) : vdisk.common.tips("error", "哎呀，该文件已被作者删除或取消分享...")
            }
          }
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0001")
        }
      }), e
    }, vdisk.api.sentWeiBo = function (a, b, c, d, e, f) {
      "undefined" == typeof d && (d = ""), "undefined" == typeof f && (f = !0);
      var g = vdisk.common.getLength(b);
      0 == g || g > 120 || $.ajax({
        url: "/share/ajaxSendShareWeibo",
        data: "fid=" + a + "&text=" + encodeURIComponent(b) + "&code=" + c + "&rand=" + Math.random() + "&cid=" + e,
        dataType: "json",
        type: "POST",
        async: !1,
        success: function (a) {
          if (vdisk.checkLogin(a))
            if ("undefined" != typeof a.errcode) a.msg && vdisk.common.tips("error", a.msg);
            else {
              var b = a.error_code;
              if (b && 0 != b) switch (a.error) {
                case "40025:Error: repeated weibo text!":
                  f && vdisk.common.tips("error", "你的微博中已经有一样的内容啦，内容重复啦。");
                  break;
                default:
                  a.error.indexOf("40095") >= 0 ? f && vdisk.common.tips("error", "您分享到微博的内容包含敏感词汇，发布失败。") : a.error.indexOf("40098") >= 0 ? f && vdisk.common.tips("error", "微博已经提交，请耐心等待管理员审核！") : f && vdisk.common.tips("error", "网络繁忙，发送微博失败。")
              } else f && vdisk.common.tips("success", "微博发送成功！"), vdisk.fileShare.closeLayer(), $("#upload_imgFrom span").html("")
            }
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0034")
        }
      })
    }, vdisk.api.postweibo = function (a, b, c) {
      a = a.trim(), 0 != a.length && ("undefined" != typeof b && (a += " " + b), $.ajax({
        url: "/share/postweibo",
        type: "POST",
        async: !1,
        data: {
          msg: a,
          source: c
        },
        dataType: "json",
        success: function (a) {
          vdisk.checkLogin(a) && (0 == a.errcode ? vdisk.common.tips("success", "微博发送成功！") : vdisk.common.tips("error", "微博发送失败！"))
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0035")
        }
      }))
    }, vdisk.api.deleteF = function (a) {
      var b = $("#fid_" + a + " td:eq(0)").attr("id").replace("ftype_is_", "");
      if (1 == b) var c = "/dir/delete?dir_id=" + a + "&rand=" + Math.random();
      else var c = "/file/delete?fid=" + a + "&rand=" + Math.random();
      $.ajax({
        url: c,
        async: !1,
        dataType: "json",
        type: "POST",
        success: function (a) {
          if (vdisk.checkLogin(a)) {
            vdisk.filemanager.refresh(), $.unblockUI();
            var b = a.err_code;
            switch (b) {
              case 0:
                check_button_status();
                break;
              case 2:
                vdisk.common.tips("error", "您操作的文件或文件夹不存在。");
                break;
              case 3:
                vdisk.common.tips("error", "该文件或文件夹已经被锁。");
                break;
              case 5:
                vdisk.common.tips("error", "系统错误。");
                break;
              case 602:
                vdisk.common.tips("error", "系统错误，请重试");
                break;
              case 702:
                vdisk.common.tips("error", "验证失败，请重试");
                break;
              case 900:
                vdisk.common.tips("error", "超出了请求限制。");
                break;
              case 40603:
                vdisk.common.tips("error", "要删除的文件或目录数太多，删除失败。");
                break;
              default:
                vdisk.common.tips("error", "删除失败。")
            }
          }
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0039")
        }
      })
    }, vdisk.api.friendShip = function (a) {
      var b = new Array;
      return $.ajax({
        url: "/friendShip?id=" + a,
        cache: !1,
        dataType: "json",
        async: !1,
        success: function (a) {
          vdisk.checkLogin(a) && "undefined" == typeof a.error_code && (b[0] = a.source.following, b[1] = a.target.screen_name)
        },
        error: function () {}
      }), b
    }, vdisk.api.addFriend = function (a) {
      var b = !0;
      return $.ajax({
        url: "/share/add_friend",
        data: "uid=" + a,
        dataType: "json",
        type: "POST",
        async: !1,
        success: function (a) {
          if (vdisk.checkLogin(a)) {
            var c = a.err_code;
            c && 0 != c ? (vdisk.common.tips("error", "添加好友失败"), b = !1) : b = !0
          }
        },
        error: function () {}
      }), b
    }, vdisk.contentFilter = function (a, b) {
      var c = vdisk.common.HTMLFilter(a, 0);
      return c = c.replace(/(http:\/\/[\w\d\.-_\/]*)/g, "<a " + b + " name='$1' target='_blank' href='$1'>$1</a>"), c = c.replace(/(@([0-9a-zA-Z\u4e00-\u9fa5_-]+))/g, "<a nameid=\"$1\" onclick=\"$(this).attr('href','http://weibo.com/n/'+$(this).attr('nameid').substr(1));$(this).attr('target','_blank');\">$1</a>")
    }, vdisk.weiboContentToHtml = function (a) {
      return a = vdisk.common.HTMLFilter(a, 0), a = a.replace(/(http:\/\/[\w\d\.-_\/]*)/g, '<a target="_blank" href="$1">$1</a>'), a = a.replace(/(@([^<>\(\):,.!;@\s，：（）]*))/g, '<a target="_blank" href="http://weibo.com/n/$2">$1</a>')
    }, vdisk.api.weiboUrlExpand = function (a, b) {
      var c = !1,
        b = b.slice(12, b.length),
        d = "/share/weiboUrlExpand?url_short=" + b;
      return $.ajax({
        url: d,
        cache: !0,
        async: !1,
        dataType: "json",
        success: function (b) {
          var d = b[0].url_long;
          (/http:\/\/vdisk.weibo.com\/s\//.test(d) || /http:\/\/www.weipan.cn\//.test(d)) && ($(a).removeAttr("href"), c = d)
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0045")
        }
      }), c
    }, vdisk.api.videoUrlExpand = function (a, b) {
      var c = !1,
        b = b.slice(12, b.length),
        d = "/share/weiboUrlExpand?url_short=" + b;
      return $.ajax({
        url: d,
        async: !1,
        success: function (b) {
          var d = b[0].url_long;
          /http:\/\/video\.sina\.com\.cn\/v\//.test(d) && ($(a).removeAttr("href"), c = d), $.ajax({
            url: "/share/sinaVideoInfo",
            data: {
              url: d
            },
            dataType: "json",
            async: !1,
            success: function (a) {
              c = a, "undefined" == typeof c.playswf && (c = !1)
            },
            error: function () {
              c = !1
            }
          })
        },
        error: function () {
          vdisk.common.tips("timeout", "0x0046")
        }
      }), c
    }, vdisk.addRelation = function () {
      "block" == $("#addRelationCheck").css("display") && $("#addRelationCheck input").attr("checked") && vdisk.api.addFriend($("#addRelationMain").attr("uid"))
    }, vdisk.savePopup = function (a) {
      var b = vdisk.tree.dirTreeViewer("save", 0, !0),
        c = vdisk.tree.dirCreator("save"),
        d = '                <div class="W_layer">                    <div class="bg">                        <table>                            <tbody>                                <tr>                                    <td>                                        <div class="content">                                            <div class="title">保存到微盘</div>                                            <a class="W_close" href="javascript:$.unblockUI();"></a>                                            <div class="detail main_tree_body">                                                <div class="main_tree_word clearfix" style="height:20px;">请选择保存目录<div style="float:right;">' + c + '</div></div>                                                <div class="main_tree_wrap">                                                    ' + b + '                                                </div>                                                <div class="btn"><a class="W_btn_b" onclick="vdisk.saveForwardSubmit(\'#save_popup\');"><span>保存并转发</span></a><a class="W_btn_a" onclick="vdisk.saveSubmit(' + a + ');"><span>直接保存</span></a></div>                                             </div>                                        </div>                                    </td>                                </tr>                            </tbody>                        </table>                    </div>                </div>            ';
      $.blockUI({
        message: d
      });
      var e = vdisk.settings.getByKey("save_path", !0);
      e ? vdisk.tree.locateAndActiveDir("save", e) : (vdisk.tree.toggleChildDir("save", 0), vdisk.tree.setActiveDirId("save", 0))
    }, vdisk.saveSubmit = function (a) {
      var b = vdisk.tree.getActiveDirId("save");
      vdisk.api.saveToMe(a, b)
    }, vdisk.feedNum = {
      feedNumTime: 0,
      api: function () {
        var a = "",
          b = "/share/newShareNum?ptime=" + $.cookie("feedNumTime" + uid);
        return $.ajax({
          url: b,
          async: !1,
          dataType: "json",
          success: function (b) {
            a = b, $.cookie("feedNumTime" + uid, a.time, {
              expires: 7,
              domain: "vdisk.weibo.com"
            })
          },
          error: function () {}
        }), a
      },
      showFun: function (a, b) {
        var c = $(a + " .feedNum"),
          d = parseFloat(c.text()),
          e = d + b;
        e > 99 && (e = "99+"), c.show().html("<font>" + e + "</font>")
      },
      show: function () {
        var a = this.api();
        0 != a.friendNum && null != a.friendNum && vdisk.feedNum.showFun("#tab_share_fd", a.friendNum), 0 != a.popNum && null != a.popNum && vdisk.feedNum.showFun("#tab_share_re", a.popNum), 0 != a.myNum && null != a.myNum && vdisk.feedNum.showFun("#tab_share_my", a.myNum), 0 != a.newNum && null != a.newNum && vdisk.feedNum.showFun("#tab_share_new", a.newNum), 0 != a.hotNum && null != a.hotNum && vdisk.feedNum.showFun("#tab_share_hot", a.hotNum)
      },
      init: function () {
        $("#tab_share_hot").length && (setTimeout(function () {
          vdisk.feedNum.show()
        }, 1500), setInterval(function () {
          vdisk.feedNum.show()
        }, 6e4))
      }
    }, vdisk.cache = {
      k: [],
      v: [],
      has: function (a) {
        return vdisk.array_index(this.k, a) >= 0
      },
      set: function (a, b) {
        var c = vdisk.array_index(this.k, a);
        c >= 0 ? this.v[c] = b : (this.k.push(a), this.v.push(b))
      },
      get: function (a) {
        var b = vdisk.array_index(this.k, a);
        return b >= 0 ? this.v[b] : null
      },
      remove: function (a) {
        var b = vdisk.array_index(this.k, a);
        b >= 0 && (delete this.k[b], delete this.v[b])
      },
      clear: function () {
        this.k = [], this.v = []
      }
    }, vdisk.counter = {
      k: [],
      v: [],
      get: function (a) {
        var b = vdisk.array_index(this.k, a);
        return 0 > b ? 0 : this.v[b]
      },
      inc: function (a) {
        var b = vdisk.array_index(this.k, a);
        return 0 > b ? (this.k.push(a), this.v.push(1), 1) : (this.v[b]++, this.v[b])
      },
      dec: function (a) {
        var b = vdisk.array_index(this.k, a);
        return 0 > b ? 0 : (this.v[b] > 0 && this.v[b]--, this.v[b])
      },
      reset: function (a) {
        var b = vdisk.array_index(this.k, a);
        b >= 0 && (this.v[b] = 0)
      }
    }, vdisk.lock = {
      lock: function (a) {
        1 == vdisk.counter.inc("lock." + a)
      },
      unlock: function (a) {
        vdisk.counter.reset("lock." + a)
      },
      isLocked: function (a) {
        return vdisk.counter.get("lock." + a) > 0
      }
    }, vdisk.showTopshare = {
      cache: [],
      totalPage: 0,
      page: 0,
      show: function (a) {
        if (this.page = a + 1, this.totalPage && this.page > this.totalPage && (this.page = 1), "undefined" == typeof this.cache[this.page]) {
          var b = this.page;
          vdisk.api.getRankingShare(this.page, function (a) {
            a ? 0 == a.length ? (vdisk.showTopshare.totalPage = b - 1, vdisk.showTopshare.show(0)) : (vdisk.showTopshare.cache[b] = a, vdisk.showTopshare.render(a)) : vdisk.showTopshare.page--
          })
        } else this.render(this.cache[this.page])
      },
      render: function (a) {
        var b = "",
          c = "",
          d = "";
        $.each(a, function (e) {
          if (null != a[e] && "undefined" != typeof a[e].id) {
            c = "undefined" != typeof a[e].following && 0 == a[e].following ? 'onclick="if( api_addFriend(' + a[e].id + ') ){ $(this).remove(); }"' : "", d = siteurl + "u/" + a[e].id;
            var f = "",
              g = "",
              h = "",
              i = "";
            (200 == a[e].verified_type || 220 == a[e].verified_type) && (f = '<img width="11" height="10" class="ico_club" alt="微博达人" title="微博达人" src="' + STATIC_URL + 'images/common/transparent.gif">'), 1 == a[e].verified && 0 == a[e].verified_type && (g = '<img width="11" height="10" class="approve" alt="新浪个人认证" title="新浪个人认证" src="' + STATIC_URL + 'images/common/transparent.gif">'), 1 == a[e].verified && 0 != a[e].verified_type && (h = '<img width="11" height="10" class="approve_co" alt="新浪机构认证" title="新浪机构认证" src="' + STATIC_URL + 'images/common/transparent.gif">'), 1 == a[e].vip_members && (i = '<a title="微博会员" alt="微博会员" target="_blank" href="http://vip.weibo.com/prividesc?priv=1108"><em class="vd_ico_member"></em></a>'), b += '<dl class="interPer clearfix interPerHover"><dt><a href="' + d + '" title="' + a[e].screen_name + '的分享" suda-uatrack="key=vdisksina&value=right_popshare"><img width="50" height="50" src="' + a[e].profile_image_url + '" imgtype="head" uid="' + a[e].id + '" alt="' + a[e].screen_name + '" title="' + a[e].screen_name + '"></a></dt><dd><p class="name"><a href="' + d + '" title="' + a[e].screen_name + '" suda-uatrack="key=vdisksina&value=right_popshare">' + vdisk.common.substr(a[e].screen_name, 7) + "</a>" + f + g + h + i + '</p><p class="info"><a title="分享" href="' + d + '" class="W_linkb" suda-uatrack="key=vdisksina&value=right_popshare">分享<strong>' + a[e].count_public + '</strong>个</a></p><p><!--<a class="add ico_add" ' + c + ' alt="加关注" title="加关注"></a><a class="W_close" title="不感兴趣"></a>--></p></dd></dl>'
          }
        }), $("#topshareList").html(b), refreshShowTopshare = setTimeout("vdisk.showTopshare.show(" + vdisk.showTopshare.page + ")", 2e4)
      },
      add: function (a) {
        clearTimeout(refreshShowTopshare), this.show(a)
      },
      init: function () {
        $("#pop_user_container").length && (this.show(0), $("#pop_user_next").click(function () {
          clearTimeout(refreshShowTopshare), vdisk.showTopshare.show(vdisk.showTopshare.page)
        }))
      }
    }, vdisk.like_for_user = {
      show: function (a) {
        a ? a.length < 1 ? $("#right_like_file_container").hide() : (a.length < 5 && $("#right_like_for_user_next").hide(), vdisk.like_for_user.render(a), $("#right_like_file_container").show()) : $.getJSON("/file/recommend_for_user?_=" + parseInt(10 * Math.random()), function (a) {
          vdisk.like_for_user.show(a)
        })
      },
      hide: function () {
        $("#right_like_file_container").hide()
      },
      render: function (a) {
        if (a.length < 1) return !1;
        var b = "",
          c = "",
          d = "",
          e = window.location.href;
        null != e.match("share") ? (c = "hot", d = "right_recommend_for_user") : (c = "user", d = "down_recommend_for_user"), $.each(a, function (e) {
          if ("1111551984" == a[e].app_key) {
            var f = siteurl + "book/" + a[e].source_id;
            b += '<li><i class="vd_icon16_v2 vd_16book"><a target="_blank" href="' + f + "?t=" + c + '" suda-uatrack="key=vdisksina&value=' + d + '" title="' + a[e].name + '">' + vdisk.common.substr(a[e].name, 11) + "</a></i> <p><span>分享时间：" + a[e].time.substring(0, 10) + "</span></p></li>"
          } else b += '<li><i class="vd_icon16_v2 vd_16' + a[e].icon + '"><a target="_blank" href="' + a[e].link + "?t=" + c + '" suda-uatrack="key=vdisksina&value=' + d + '" title="' + a[e].name + '">' + vdisk.common.substr(a[e].name, 11) + "</a></i> <p><span>分享时间：" + a[e].time.substring(0, 10) + "</span></p></li>"
        }), $("#right_like_file_container #right_like_file").html(b)
      },
      init: function () {
        $("#right_like_file_container").length && (this.hide(), $("#right_like_for_user_next").click(function () {
          vdisk.like_for_user.show()
        }))
      }
    }, vdisk.right_navigation = {
      init: function () {
        $(".ff_category_box").delegate(".category_box", "hover", function (a) {
          $(this).toggleClass("category_box_hover", "mouseenter" == a.type)
        })
      }
    }, vdisk.bottom_recommend_for_file = {
      copy_ref: "",
      cid: 0,
      show: function (a) {
        a ? a.length < 1 || "undefined" != typeof a.error_code ? $("#bottom_recommend_for_file").hide() : (vdisk.bottom_recommend_for_file.render(a), $("#bottom_recommend_for_file").show()) : $.getJSON("/file/recommend_for_file?_=" + parseInt(10 * Math.random()) + "&copy_ref=" + this.copy_ref + "&cid=" + this.cid, function (a) {
          vdisk.bottom_recommend_for_file.show(a)
        })
      },
      render: function (a) {
        if (a.length < 1) return !1;
        var b = "";
        $.each(a, function (c) {
          if ("1111551984" == a[c].app_key) {
            var d = siteurl + "book/" + a[c].source_id;
            b += '<li class="vd_suggest_bg clearfix"><span class="vd_icon16_v2 vd_16book"><a href="' + d + '?t=file" suda-uatrack="key=vdisksina&value=down_recommend_file">' + vdisk.common.substr(a[c].name, 30) + '</a></span><span class="vd_suggest_down"></span></li>'
          } else {
            var e = vdisk.common.getFileIco(a[c].name, !1);
            b += '<li class="vd_suggest_bg clearfix"><span class="vd_icon16_v2 vd_16' + e[1] + '"><a href="' + a[c].link + '?t=file" suda-uatrack="key=vdisksina&value=down_recommend_file">' + vdisk.common.substr(a[c].name, 30) + '</a></span><span class="vd_suggest_down"><em>' + a[c].count_download + "</em>次下载</span></li>"
          }
        }), $("#bottom_recommend_for_file ul").html(b)
      },
      init: function (a, b) {
        this.copy_ref = a, this.cid = b, $("#bottom_recommend_for_file").length && this.show()
      }
    }, vdisk.slideshowRecommend = {
      data: [],
      loaded: [],
      current: 0,
      timer: null,
      timeout: 3e3,
      init: function () {
        0 != $("#slideshow_recommend_container").length && ($("#slideshow_recommend_prev").click(function () {
          vdisk.slideshowRecommend.prev()
        }), $("#slideshow_recommend_next").click(function () {
          vdisk.slideshowRecommend.next()
        }), $("#slideshow_recommend_content").hover(function () {
          $("#slideshow_recommend_prev, #slideshow_recommend_next").toggle()
        }), $.ajax({
          url: "/share/ajaxSlideShare?_=" + Math.random(),
          dataType: "json",
          success: function (a) {
            vdisk.slideshowRecommend.data = a, vdisk.slideshowRecommend.play(0)
          }
        }))
      },
      play: function (a) {
        if (this.data) {
          this.current = a, this.show(this.current);
          var b;
          b = this.current >= this.data.length - 1 ? 0 : this.current + 1, this.timer = setTimeout("vdisk.slideshowRecommend.play(" + b + ")", this.timeout)
        }
      },
      prev: function () {
        if (this.data) {
          clearTimeout(this.timer);
          var a;
          a = 0 == this.current ? this.data.length - 1 : this.current - 1, this.play(a)
        }
      },
      next: function () {
        if (this.data) {
          clearTimeout(this.timer);
          var a;
          a = this.current >= this.data.length - 1 ? 0 : this.current + 1, this.play(a)
        }
      },
      isLoaded: function (a) {
        return vdisk.array_index(this.loaded, a) > -1
      },
      show: function (a) {
        $("#slideshow_recommend_content>div:visible").hide();
        var b = "slideshow_recommend_content_" + a;
        if (!this.isLoaded(a)) {
          var c = this.data[a],
            d = vdisk.common.getFileIco(c.filename, !1),
            e = "";
          c.username && (e = "分享者:" + c.username.substring(0, 7)), $("#slideshow_recommend_content").append('                    <div id="' + b + '" style="display:none;">                    <a href="' + c.url + '" class="hot_share_pic" >                        <img src="' + c.pic + '" width="190" height="140" />                        <div class="hot_share_shadow"></div>                        <div class="hot_share_infor clearfit"><font>' + e + "</font><span>" + c.count + '</span><span class="vd_fire"></span></div>                     </a>                     <a href="' + c.url + '" class="vd_icon16_v2_share vd_16' + d[1] + '_share"><span class="pic"></span><span>' + c.filename + "</span></a>                    </div>                "), this.loaded.push(a)
        }
        $("#" + b).fadeIn("fast")
      }
    }, vdisk.category = {
      showTab: function (a, b, c, d) {
        vdisk.category.getList(b, function (b) {
          var e = 'class="vd_type_normal"';
          "undefined" == typeof c && (c = 0), 0 == c && (e = 'class="vd_type_select"');
          for (var f = '<a rel="0" ' + e + ">全部</a>", g = 0; g < b.length; g++) e = 'class="vd_type_normal"', b[g].category_id == c && (e = 'class="vd_type_select"'), f += '<span class="vd_pic_v2 vd_type_line"></span><a rel="' + b[g].category_id + '" ' + e + ' suda-uatrack="key=vdisksina&value=category_' + b[g].category_id + '">' + b[g].category_name + "</a>";
          $(a).html(f).show(), $(a).find("[rel]").click(function () {
            d.call(null, $(this).attr("rel"))
          })
        })
      },
      init: function () {
        this.fillSelect($("#send_weibo_cid")), $("#send_weibo_cid2").hide().find("option:gt(0)").remove(), 1 == vdisk.counter.inc("bind_select_category") && $("#send_weibo_cid").change(function () {
          vdisk.category.syncCategory($("#send_weibo_cid"), $("#send_weibo_cid2"))
        })
      },
      syncCategory: function (a, b) {
        var c = a.val();
        b.toggle(0 != c), 0 == c ? b.val(0).hide() : (b.show(), vdisk.category.fillSelect(b, c))
      },
      fillSelect: function (a, b, c, d) {
        a.find("option:gt(0)").remove(), "undefined" == typeof c && (c = 0), this.getList(b, function (b) {
          var e, f = "";
          for (e = 0; e < b.length; e++) f += '<option value="' + b[e].category_id + '"', c == b[e].category_id && (f += ' selected="selected" '), f += ">" + b[e].category_name + "</option>";
          a.append(f), "function" == typeof d && d.call()
        })
      },
      getList: function (a, b) {
        "undefined" == typeof a && (a = 0);
        var c = "category-" + a;
        return vdisk.cache.has(c) ? void b.call(this, vdisk.cache.get(c)) : (data = {}, a && (data.pid = a), void $.ajax({
          url: "/share/ajaxGetCategoryList",
          data: data,
          cache: !0,
          dataType: "json",
          success: function (a) {
            vdisk.cache.set(c, a), b.call(this, a)
          }
        }))
      }
    }, vdisk.tollbarFixed = function () {
      if (0 != $("#tollbarFixed").length) {
        var b = $("#tollbarFixed"),
          c = b.offset().top;
        $(window).scroll(function () {
          $scrollLeft = $(document).scrollLeft(), $scrollTop = $(document).scrollTop(), $scrollTop > c ? vdisk.common.isIe6() ? ($('#moreOperateLayer[fixed="true"]').css(4 == $CONFIG._wv ? {
            position: "absolute",
            top: 43 + $scrollTop
          } : {
            position: "absolute",
            top: 50 + $scrollTop
          }), b.css({
            position: "absolute",
            top: $scrollTop,
            left: $("#page_list").offset().left,
            zIndex: "1"
          })) : ($('#moreOperateLayer[fixed="true"]').css(a.browser.ie7 ? {
            top: "101px"
          } : {
            position: "fixed",
            top: "101px"
          }), b.css(4 == $CONFIG._wv ? {
            position: "fixed",
            top: "43px",
            zIndex: "1"
          } : {
            position: "fixed",
            top: "50px",
            zIndex: "1"
          })) : ($('#moreOperateLayer[fixed="true"]').css({
            position: "absolute",
            top: c + 50
          }), b.css({
            position: "relative",
            top: "0",
            left: "auto",
            zIndex: "1"
          }))
        })
      }
    }, vdisk.noviceTask = {
      init: function () {
        "undefined" != typeof $RIGHT_NOVICE_TASK && $RIGHT_NOVICE_TASK && ($(".vd_client_main").hide(), $(".novice_close").click(function () {
          $(".vd_get_task_wrap").hide(), $(".vd_client_main").show(), vdisk.notice.receiveByTypeApi(vdisk.notice.types.RIGHT_NOVICE_TASK_STAT, function (a) {
            0 != a.errcode ? vdisk.common.tips("error", vdisk.notice.types.RIGHT_NOVICE_TASK_STAT + " 设置出错了!") : ($(".vd_get_task_wrap").remove(), $RIGHT_NOVICE_TASK = 0)
          })
        }), $("#novice_dl a").each(function () {
          var a = $(this).attr("id") + "_tips",
            b = $(this).attr("stat");
          "undefined" != typeof b && "completed" != b && ($(this).hover(function () {
            $("#" + a).show()
          }, function () {
            $("#" + a).hide()
          }), $("#" + a).hover(function () {
            $(this).show()
          }, function () {
            $(this).hide()
          }))
        }))
      }
    }, vdisk.noviceNotice = {
      novice: {
        templete: '                <div class="vd_task_wrap">                     <div class="vd_task_head"></div>                     <div class="vd_task_body">                          <p class="vd_task_close"><a class="novice_task_guide" href="javascript:void(0);"><span class="vd_pic_v2 vd_secret_close_btn"></span></a></p>                          <p class="vd_task_see">做任务，赢  <strong>20G</strong> 空间</p>                          <p><a class="vd_bt_v2 vd_know_btn novice_task_list" href="javascript:void(0);">去看看</a></p>                     </div>                     <div class="vd_task_foot"></div>                     <div class="vd_task_arrow"></div>                </div>            ',
        show: function () {
          $(".vd_task_wrap").remove(), $("body").append(this.templete), a.stick({
            stickTo: $(".vd_task_wrap"),
            stick: $(".novice_task_flag"),
            css: {
              top: -136,
              left: -103
            }
          }), $(".novice_task_guide").click(function () {
            vdisk.notice.receiveByType(vdisk.notice.types.NOTICE_TYPE_NOVICE_TASK, function () {
              $(".vd_task_wrap").remove(), vdisk.notice.handle()
            })
          }), $(".novice_task_list").click(function () {
            vdisk.notice.receiveByType(vdisk.notice.types.NOTICE_TYPE_NOVICE_TASK, function () {
              $(".vd_task_wrap").remove(), window.location.href = "/task/novice"
            })
          })
        }
      }
    }, vdisk.capacityNoviceStatus = {
      init: function () {
        var b = $("#vdisk_capacity"),
          c = 20;
        if (b.length) {
          {
            b.data("get_quota")
          }
          $("body").append(this.template), $(".my_infor_main").on("mouseover mouseout click", "#vdisk_capacity", function (b) {
            var d = $(this).data("get_quota");
            if ("mouseover" == b.type) {
              var e = c - d;
              $(".remain_capacity_novice_tip").html('<span class="vd_pic_v2 vd_yun_tip_bt"></span>做任务，再得' + e + "G空间。"), a.stick({
                stickTo: $(".capacity_novice_tip"),
                stick: $("#vdisk_capacity"),
                css: {
                  top: -70,
                  left: 0
                }
              }), $(".capacity_novice_tip").show()
            } else "mouseout" == b.type ? $(".capacity_novice_tip").hide() : "click" == b.type && ($("#vdisk_capacity").data("flag") || ($("#vdisk_capacity").data("flag", !0), vdisk.capacityNoviceStatus.rectifyCapacity()), setTimeout(function () {
              window.location = "/task/novice"
            }, 300))
          }), $("#vdisk_capacity").on("mouseover mouseout", ".capacity_body", function (a) {
            $(".capacity_novice_tip").hide(), ("mouseover" == a.type || "mouseout" == a.type) && a.stopPropagation()
          })
        }
      },
      rectifyCapacity: function () {
        b.api({
          url: "api/weipan/2/account/rep_used"
        }, function (a) {}, function (a) {}, function () {
          $("#vdisk_capacity").data("flag", !1)
        })
      },
      template: '<div style="display:none;" class="W_layer capacity_novice_tip">                    <div class="task_layer">                    <div class="sort_yun_arrow_tip"></div>                    <p class="remain_capacity_novice_tip"></p>                    </div>                </div>'
    }, vdisk.advertise = {
      init: function () {
        $(".advertise-list").each(function () {
          function a() {
            var b = f + 1;
            b >= d && (b = 0), $("#" + e + "-" + f).hide(), $("#" + e + "-" + b).show(), f = b, setTimeout(a, 1e3 * c)
          }
          var b = $(this),
            c = parseInt(b.data("time")),
            d = parseInt(b.data("count")),
            e = b.data("position"),
            f = 0;
          d > 1 && a()
        }), setTimeout(function () {
          $(".web_func_layer").slideDown("slow")
        }, 4e3);
        var a = $("#popup_content"),
          b = parseInt(a.data("id")),
          c = b,
          d = !1;

        $.cookie("popupIdCookie") && (c += "-" + $.cookie("popupIdCookie")), a.on("click", ".W_close", function () {
          d || ($.cookie("popupIdCookie", c, {
            expires: 7,
            domain: "vdisk.weibo.com",
            path: "/"
          }), d = !0), $(".web_func_layer").slideUp("slow")
        }), a.on("click", "a", function () {
          d || ($.cookie("popupIdCookie", c, {
            expires: 7,
            domain: "vdisk.weibo.com",
            path: "/"
          }), d = !0)
        }), $("#closeSwfAd").click(function () {
          $(".ads_layer").hide()
        }), $(".advertise-share-btn").click(function () {
          if (!uid) return vdisk.login(), !1;
          var a = $(this),
            b = a.data("id"),
            c = a.data("message");
          vdisk.advertise.sharePopup(b, c)
        }), $("#ad_share_send_btn").live("click", function () {
          if (vdisk.lock.isLocked("adShareSend")) return !1;
          $container = $(this).parents(".share_main");
          var a = $container.find("[name=ad_id]").val(),
            b = $container.find("[name=message]").val();
          return $(this).attr("disabled") ? (0 == b.length ? vdisk.common.tips("error", "内容不能为空") : vdisk.common.tips("error", "字数超过限制"), !1) : (vdisk.lock.lock("adShareSend"), void $.ajax({
            url: "/advertise/ajaxShareAd",
            type: "POST",
            dataType: "json",
            data: {
              id: a,
              message: b
            },
            success: function (a) {
              return vdisk.lock.unlock("adShareSend"), vdisk.checkLogin(a) ? void(0 == a.errcode ? (vdisk.common.tips("success", "微博发送成功！"), vdisk.advertise.closeSharePopup()) : vdisk.common.tips("error", a.msg)) : !1
            },
            error: function () {
              vdisk.lock.unlock("adShareSend"), vdisk.common.tips("error", "微博发送失败！")
            }
          }))
        })
      },
      sharePopup: function (a, b) {
        var c = '<div class="W_layer adShareLayer" ><div class="bg"><table><tbody><tr><td>                <div class="content">                    <div class="title">分享活动</div>                    <a class="W_close" onclick="vdisk.advertise.closeSharePopup();"></a>                    <div class="detail">                        <div class="share_layer">                            <div class="share_layer_main clearfix">                                <div class="share_top clearfix">                                    <ul class="share_menu clearfix">                                        <li class="tosinat_menu share_menu_on">分享到微博</li>                                    </ul>                                </div>                                <div class="share_main tosinat clearfix">                                    <div class="num ad_share_num"><em>还可以输入</em>79<em>字</em></div>                                    <div class="input">                                        <input type="hidden" name="ad_id" value="' + a + '">                                        <textarea class="textarea" name="message" id="ad_share_message">' + vdisk.common.HTMLFilter(b) + '</textarea>                                    </div>                                    <div class="share_main_opt clearfix">                                        <div class="btn"><a class="W_btn_b ad_share_send_btn" id="ad_share_send_btn"><span>发布</span></a></div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </td></tr></tbody></table></div></div>';
        $.blockUI({
          message: c,
          close: !1,
          maskClass: "adShareMask"
        }), $("#ad_share_message").maxlength({
          maxCharacters: 119,
          numClass: "ad_share_num",
          btnClass: "ad_share_send_btn"
        })
      },
      show_swf_ad: function () {
        b.api({
          url: "api/weipan/getAdsIsShow",
          type: "POST",
          data: {
            advert_id: 12
          }
        }, function (a) {
          a.is_show && $("#ads_layer").show()
        }, function (a) {
          vdisk.common.tips("error", a.error)
        })
      },
      closeSharePopup: function () {
        $(".adShareLayer,.adShareMask").remove()
      }
    }, vdisk.log = function (a) {
      var b = new Image,
        c = "vdisk_sio_log_" + Math.floor(2147483648 * Math.random()).toString(36);
      window[c] = b, b.onload = b.onerror = b.onabort = function () {
        b.onload = b.onerror = b.onabort = null, window[c] = null, b = null
      }, b.src = a
    }, vdisk.getQueryValue = function (a) {
      var b = location.search.match(new RegExp("[?&]" + a + "=([^&]*)(&?)", "i"));
      return b ? b[1] : b
    }, vdisk.pagemanager = {
      checkin: function () {
        seajs.use("2/page/checkin", function (a) {
          vdisk.checkin.checkin()
        })
      },
      upload: function (a) {
        null == a && (a = 0), 1 == vdisk.counter.inc("seajsUpload") ? seajs.use("vdisk/upload", function (b) {
          vdisk.upload.init(a)
        }) : vdisk.upload.init(a)
      },
      atteVdisk: function () {
        seajs.use("vdisk/task", function (a) {
          vdisk.task.atteVdisk.atteVdisk()
        })
      }
    }, vdisk
  }), define("2/cmdlib/vui", [], function () {
    return vui
  }), void 0 == vui) var vui = {};
vui.numberToArray = function (a) {
    return vui.isString(a) && (a = parseInt(a)), vui.isNumber(a) && (a = [a]), a
  }, vui.indexOf = function (a, b) {
    if (vui.isArray(a)) {
      for (var c, d = 0; d < a.length; d++) {
        if (a[d] == b) {
          c = d;
          break
        }
        c = -1
      }
      return c
    }
  }, vui.autoscroll = function (a, b) {
    var c = $(a);
    b || (b = 500);
    var d = c.offset().top;
    $("html,body").animate({
      scrollTop: d
    }, b)
  }, vui.browser = {
    ua: navigator.userAgent.toLowerCase(),
    ie: /msie/.test(navigator.userAgent.toLowerCase()),
    ie6: /msie 6/.test(navigator.userAgent.toLowerCase()),
    ie7: /msie 7/.test(navigator.userAgent.toLowerCase()),
    ie8: /msie 8/.test(navigator.userAgent.toLowerCase()),
    ie9: /msie 9/.test(navigator.userAgent.toLowerCase()),
    firefox: /firefox\/(\d+\.\d+)/i.test(navigator.userAgent.toLowerCase()),
    chrome: /chrome\/(\d+\.\d+)/i.test(navigator.userAgent.toLowerCase()),
    opera: /opera/.test(navigator.userAgent.toLowerCase()),
    webkit: /webkit/.test(navigator.userAgent.toLowerCase())
  }, vui.clickhide = vui.clickHide = function (a) {
    var b = $(a),
      c = !1;
    b.show(), b.hover(function () {
      c = !0
    }, function () {
      c = !1
    }), $("html,body").mouseup(function () {
      c || b.hide()
    })
  }, vui.contextmenu = function (a, b) {
    b = $.extend({
      menu: null,
      zIndex: 2,
      autoShow: !0,
      preventContextmenu: !0,
      diff: 2,
      callback: null
    }, b);
    var c = {
      el: a,
      menu: b.menu,
      init: function () {
        b.preventContextmenu && this.preventContextmenu(b.preventContextmenu), null == b.menu && alert("options error");
        var a = this;
        this.hide(), this.preventContextmenu(this.menu), this.setStyle(), this.el.bind("contextmenu", function (c) {
          c.preventDefault();
          var d = c.pageX + b.diff,
            e = c.pageY + b.diff;
          if (b.autoShow) {
            var f = $(window).height() + $(document).scrollTop(),
              g = e - b.diff + b.menu.outerHeight();
            g > f && (e -= b.menu.outerHeight())
          }
          b.menu.css({
            left: d,
            top: e
          }), a.show(), a.clickBodyHide()
        })
      },
      clickBodyHide: function () {
        var a = this;
        $("html").one("click", function () {
          a.hide()
        })
      },
      preventContextmenu: function (a) {
        a.bind("contextmenu", function (a) {
          return !1
        })
      },
      setStyle: function () {
        this.menu.css({
          zIndex: b.zIndex,
          position: "absolute"
        }), this.menu.appendTo("body")
      },
      show: function () {
        this.menu.show()
      },
      hide: function () {
        this.menu.hide()
      }
    };
    c.init()
  }, vui.cookie = jQuery.cookie = function (a, b, c) {
    if (arguments.length > 1 && (null === b || "object" != typeof b)) {
      if (c = jQuery.extend({}, c), null === b && (c.expires = -1), "number" == typeof c.expires) {
        var d = c.expires,
          e = c.expires = new Date;
        e.setDate(e.getDate() + d)
      }
      return document.cookie = [encodeURIComponent(a), "=", c.raw ? String(b) : encodeURIComponent(String(b)), c.expires ? "; expires=" + c.expires.toUTCString() : "", c.path ? "; path=" + c.path : "", c.domain ? "; domain=" + c.domain : "", c.secure ? "; secure" : ""].join("")
    }
    c = b || {};
    var f, g = c.raw ? function (a) {
      return a
    } : decodeURIComponent;
    return (f = new RegExp("(?:^|; )" + encodeURIComponent(a) + "=([^;]*)").exec(document.cookie)) ? g(f[1]) : null
  }, vui.counter = {
    k: [],
    v: [],
    get: function (a) {
      var b = this.k.indexOf(a);
      return 0 > b ? 0 : this.v[b]
    },
    inc: function (a) {
      var b = this.k.indexOf(a);
      return 0 > b ? (this.k.push(a), this.v.push(1), 1) : (this.v[b]++, this.v[b])
    },
    dec: function (a) {
      var b = this.k.indexOf(a);
      return 0 > b ? 0 : (this.v[b] > 0 && this.v[b]--, this.v[b])
    }
  }, Date.dayNames = ["星期天", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"], Date.abbrDayNames = ["日", "一", "二", "三", "四", "五", "六"], Date.monthNames = ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"], Date.abbrMonthNames = ["一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二"], Date.firstDayOfWeek = 1, Date.format = "yyyy-mm-dd", Date.fullYearStart = "20",
  function () {
    function a(a, b) {
      Date.prototype[a] || (Date.prototype[a] = b)
    }
    a("isLeapYear", function () {
      var a = this.getFullYear();
      return a % 4 == 0 && a % 100 != 0 || a % 400 == 0
    }), a("isWeekend", function () {
      return 0 == this.getDay() || 6 == this.getDay()
    }), a("isWeekDay", function () {
      return !this.isWeekend()
    }), a("getDaysInMonth", function () {
      return [31, this.isLeapYear() ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][this.getMonth()]
    }), a("getDayName", function (a) {
      return a ? Date.abbrDayNames[this.getDay()] : Date.dayNames[this.getDay()]
    }), a("getMonthName", function (a) {
      return a ? Date.abbrMonthNames[this.getMonth()] : Date.monthNames[this.getMonth()]
    }), a("getDayOfYear", function () {
      var a = new Date("1/1/" + this.getFullYear());
      return Math.floor((this.getTime() - a.getTime()) / 864e5)
    }), a("getWeekOfYear", function () {
      return Math.ceil(this.getDayOfYear() / 7)
    }), a("setDayOfYear", function (a) {
      return this.setMonth(0), this.setDate(a), this
    }), a("addYears", function (a) {
      return this.setFullYear(this.getFullYear() + a), this
    }), a("addMonths", function (a) {
      var b = this.getDate();
      return this.setMonth(this.getMonth() + a), b > this.getDate() && this.addDays(-this.getDate()), this
    }), a("addDays", function (a) {
      return this.setTime(this.getTime() + 864e5 * a), this
    }), a("addHours", function (a) {
      return this.setHours(this.getHours() + a), this
    }), a("addMinutes", function (a) {
      return this.setMinutes(this.getMinutes() + a), this
    }), a("addSeconds", function (a) {
      return this.setSeconds(this.getSeconds() + a), this
    }), a("zeroTime", function () {
      return this.setMilliseconds(0), this.setSeconds(0), this.setMinutes(0), this.setHours(0), this
    }), a("asString", function (a) {
      var c = a || Date.format;
      return c.split("yyyy").join(this.getFullYear()).split("yy").join((this.getFullYear() + "").substring(2)).split("mmmm").join(this.getMonthName(!1)).split("mmm").join(this.getMonthName(!0)).split("mm").join(b(this.getMonth() + 1)).split("dd").join(b(this.getDate())).split("hh").join(b(this.getHours())).split("min").join(b(this.getMinutes())).split("ss").join(b(this.getSeconds()))
    }), Date.fromString = function (a, b) {
      var c = b || Date.format,
        d = new Date("01/01/1977"),
        e = 0,
        f = c.indexOf("mmmm");
      if (f > -1) {
        for (var g = 0; g < Date.monthNames.length; g++) {
          var h = a.substr(f, Date.monthNames[g].length);
          if (Date.monthNames[g] == h) {
            e = Date.monthNames[g].length - 4;
            break
          }
        }
        d.setMonth(g)
      } else if (f = c.indexOf("mmm"), f > -1) {
        for (var h = a.substr(f, 3), g = 0; g < Date.abbrMonthNames.length && Date.abbrMonthNames[g] != h; g++);
        d.setMonth(g)
      } else d.setMonth(Number(a.substr(c.indexOf("mm"), 2)) - 1);
      var i = c.indexOf("yyyy");
      i > -1 ? (i > f && (i += e), d.setFullYear(Number(a.substr(i, 4)))) : (i > f && (i += e), d.setFullYear(Number(Date.fullYearStart + a.substr(c.indexOf("yy"), 2))));
      var j = c.indexOf("dd");
      return j > f && (j += e), d.setDate(Number(a.substr(j, 2))), isNaN(d.getTime()) ? !1 : d
    };
    var b = function (a) {
      var b = "0" + a;
      return b.substring(b.length - 2)
    }
  }(), vui.debug = function () {
    return /debug/.test(location.search)
  }, vui.defaultchars = function (a) {
    var b = $(a);
    if (!b.val()) {
      var c = b.attr("defaultchars");
      b.val(c), b.focusin(function () {
        b.val() == c && b.val("")
      }).focusout(function () {
        "" == b.val() && b.val(c)
      })
    }
  }, vui.dialog = jQuery.fn.dialog = function (a, b) {
    function c() {
      d();
      var b = vui.browser.ie6,
        c = {
          position: b ? "absolute" : "fixed",
          top: null == a.css.top ? ($(window).height() - e.height()) / 2 + (b ? $(window).scrollTop() : 0) : a.css.top,
          left: null == a.css.left ? ($(window).width() - e.width()) / 2 + (b ? $(window).scrollLeft() : 0) : a.css.left
        };
      a.fixed || (c.position = "absolute"), i.css(c)
    }

    function d() {
      a.autoClientX && e.css({
        width: $(window).width()
      }), a.autoClientY && e.css({
        height: $(window).height()
      })
    }
    var e = "";
    a = $.extend({
      message: null,
      mask: !0,
      opacity: .15,
      drag: !1,
      maskClass: "vuiDialogMask",
      dialogClass: "vuiDialog",
      close: !0,
      maskIframe: !1,
      appendType: !0,
      stick: null,
      autoClientX: !1,
      autoClientY: !1,
      fixed: !0,
      css: {
        width: null,
        height: null,
        top: null,
        left: null,
        zIndex: 9998
      }
    }, a);
    var f, g = vui.isObject(a.message),
      h = a.stick;
    a.mask && (f = $(document.createElement("div")), f.attr("class", a.maskClass), f.addClass("vuiMaskLayer"), f.css({
      position: "absolute",
      zIndex: a.css.zIndex,
      left: 0,
      top: 0,
      opacity: a.opacity,
      backgroundColor: "#000",
      width: vui.pageSize().docWidth,
      height: vui.pageSize().docHeight
    }), $("." + a.maskClass)[0] || f.appendTo("body"), (vui.browser.ie6 || a.maskIframe) && f.append('<iframe src="javascript:;" class="vuiSelectBug" frameBorder="0" style="width:100%;height:100%;position:absolute;z-index:' + (a.css.zIndex + 1) + ';opacity:0;filter:alpha(opacity=0);top:0;left:0;">'), $(window).resize(function () {
      var b = {
        width: vui.pageSize().docWidth,
        height: vui.pageSize().docHeight
      };
      $("." + a.maskClass).css(b)
    })), g && (a.appendType && a.message.appendTo("body"), a.message.css({
      top: 0,
      left: 0
    }));
    var i = $(document.createElement("div"));
    vui.isString(a.message) ? (i.append(a.message), e = i.children().first()) : g ? e = a.message : i.append(e), e.css({
      "float": "left",
      position: "",
      top: "",
      bottom: "",
      left: "",
      right: ""
    }), d(), i.attr("class", a.dialogClass), g || i.appendTo("body"), g && (i = a.message);
    var j = {
      position: "absolute",
      zIndex: a.css.zIndex + 2,
      display: "block"
    };
    h && (j.left = h.offset().left + a.css.left, j.top = h.offset().top + a.css.top), i.css(j), h || c(), vui.browser.ie6 && !h && a.fixed && $(window).bind("scroll", function () {
      c()
    }), $(window).resize(function () {
      h ? i.css({
        left: h.offset().left + a.css.left,
        top: h.offset().top + a.css.top
      }) : c()
    }), $(".dialogclose", i).click(function () {
      i.remove(), f.remove()
    }), $(window).data("dialog.options.close", a.close), $(window).data("dialog.maskObj", f), $(window).data("dialog.dialogObj", i), b && b(), a.close && vui.preventScroll.init()
  }, $.blockUI = $.fn.blockUI = function (a, b) {
    vui.dialog(a, b)
  }, vui.undialog = jQuery.fn.dialog = $.unblockUI = function () {
    if ($(window).data("dialog.maskObj") && 1 == $(window).data("dialog.options.close")) {
      $(window).data("dialog.maskObj").remove(), $(window).data("dialog.dialogObj").remove();
      var a = $(".vuiMaskLayer:last");
      a.is(":visible") && "hidden" != a.css("visibility") || vui.preventScroll.destroy()
    }
  }, vui.drag = function (a, b) {
    b = $.extend({
      lockX: !1,
      lockY: !1,
      start: null,
      drag: null,
      end: null,
      maxLeft: null,
      maxRight: null,
      maxTop: null,
      maxBottom: null
    }, b);
    var c = {
      dragging: null,
      init: function () {
        this.bind()
      },
      diffX: 0,
      diffY: 0,
      unbind: function () {
        $(document).unbind("mousedown").unbind("mousemove").unbind("mouseup")
      },
      bind: function () {
        var c = this;
        $(document).bind("mousedown", function (d) {
          d.target.className == a.attr("class") && (c.dragging = !0, c.diffX = d.clientX - a.offset().left, c.diffY = d.clientY - a.offset().top, null != b.start && b.start.call())
        }).bind("mousemove", function (d) {
          if (c.dragging) {
            var e, f;
            b.lockY || (e = d.clientY - c.diffY, null != b.maxTop && e < b.maxTop && (e = b.maxTop), null != b.maxBottom && e > b.maxBottom && (e = b.maxBottom), a.css({
              top: e
            })), b.lockX || (f = d.clientX - c.diffX, null != b.maxLeft && e < b.maxLeft && (e = b.maxLeft), null != b.maxRight && e > b.maxRight && (e = b.maxRight), a.css({
              left: f
            }));
            var g = [e, f];
            void 0 == e && (g = f), void 0 == f && (g = e), null != b.drag && b.drag.call(null, g)
          }
        }).bind("mouseup", function (a) {
          null != b.end && b.end.call(), c.dragging = !1
        })
      }
    };
    c.init()
  }, vui.fixed = function (a, b) {
    b = $.extend({
      top: null,
      bottom: null,
      left: null,
      right: null,
      place: null,
      zIndex: 2
    }, b);
    var c = {
      isIe6: vui.browser.ie6,
      init: function () {
        var c = "fixed";
        this.isIe6 && (c = "absolute"), a.css({
          position: c,
          zIndex: b.zIndex,
          top: "",
          bottom: "",
          left: "",
          right: ""
        }), this.set(), this.bindResize(), this.bindScroll()
      },
      set: function () {
        b.place ? this.place() : this.normal()
      },
      normal: function () {
        var c = {};
        null != b.top && (c.top = this.isIe6 ? b.top + this.css.scrollTop() : b.top), null != b.left && (c.left = this.isIe6 ? b.left + this.css.scrollLeft() : b.left), null != b.bottom && (this.isIe6 ? c.top = this.css.top() - b.bottom : c.bottom = b.bottom), null != b.right && (this.isIe6 ? c.left = this.css.left() - b.right : c.right = b.right), a.css(c)
      },
      place: function () {
        var a = b.place;
        this[a]()
      },
      bindScroll: function () {
        var a = this;
        $(window).bind("scroll", function () {
          a.set()
        })
      },
      bindResize: function () {
        var a = this;
        $(window).resize(function () {
          a.set()
        })
      },
      css: {
        center: function () {
          return $(window).width() / 2 + this.scrollLeft() - a.outerWidth() / 2
        },
        top: function () {
          return $(window).height() + this.scrollTop() - a.outerHeight()
        },
        left: function () {
          return $(window).width() + this.scrollLeft() - a.outerWidth()
        },
        scrollTop: function () {
          return $(document).scrollTop()
        },
        scrollLeft: function () {
          return $(document).scrollLeft()
        }
      },
      bottomLeft: function () {
        if (this.isIe6) {
          var b = this.css.scrollLeft(),
            c = this.css.top();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          left: 0,
          bottom: 0
        })
      },
      bottomCenter: function () {
        if (this.isIe6) {
          var b = this.css.center(),
            c = this.css.top();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          left: "50%",
          bottom: 0,
          marginLeft: -a.outerWidth() / 2
        })
      },
      bottomRight: function () {
        if (this.isIe6) {
          var b = this.css.left(),
            c = this.css.top();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          right: 0,
          bottom: 0
        })
      },
      topLeft: function () {
        if (this.isIe6) {
          var b = this.css.scrollLeft(),
            c = this.css.scrollTop();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          left: 0,
          top: 0
        })
      },
      topCenter: function () {
        if (this.isIe6) {
          var b = this.css.center(),
            c = this.css.scrollTop();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          left: "50%",
          top: 0,
          marginLeft: -a.outerWidth() / 2
        })
      },
      topRight: function () {
        if (this.isIe6) {
          var b = this.css.left(),
            c = $(document).scrollTop();
          a.css({
            left: b,
            top: c
          })
        } else a.css({
          right: 0,
          top: 0
        })
      }
    };
    c.init()
  }, vui.focusclass = vui.focusClass = function (a, b) {
    var c = $(a);
    c.focus(function () {
      c.toggleClass(b)
    }).blur(function () {
      c.toggleClass(b)
    })
  }(function (a, b, c, d) {
    function e(a) {
      return a = a || location.href, "#" + a.replace(/^[^#]*#?(.*)$/, "$1")
    }
    var f, g = "hashchange",
      h = c,
      i = $.event.special,
      j = h.documentMode,
      k = "on" + g in b && (j === d || j > 7);
    $.fn[g] = function (a) {
      return a ? this.bind(g, a) : this.trigger(g)
    }, $.fn[g].delay = 50, i[g] = $.extend(i[g], {
      setup: function () {
        return k ? !1 : void $(f.start)
      },
      teardown: function () {
        return k ? !1 : void $(f.stop)
      }
    }), f = function () {
      function a() {
        var d = e(),
          f = m(i);
        d !== i ? (l(i = d, f), $(b).trigger(g)) : f !== i && (location.href = location.href.replace(/#.*/, "") + f), c = setTimeout(a, $.fn[g].delay)
      }
      var c, f = {},
        i = e(),
        j = function (a) {
          return a
        },
        l = j,
        m = j;
      return f.start = function () {
        c || a()
      }, f.stop = function () {
        c && clearTimeout(c), c = d
      }, $.browser.msie && !k && function () {
        var b, c;
        f.start = function () {
          b || (c = $.fn[g].src, c = c && c + e(), b = $('<iframe tabindex="-1" title="empty"/>').hide().one("load", function () {
            c || l(e()), a()
          }).attr("src", c || "javascript:0").insertAfter("body")[0].contentWindow, h.onpropertychange = function () {
            try {
              "title" === event.propertyName && (b.document.title = h.title)
            } catch (a) {}
          })
        }, f.stop = j, m = function () {
          return e(b.location.href)
        }, l = function (a, c) {
          var d = b.document,
            e = $.fn[g].domain;
          a !== c && (d.title = h.title, d.open(), e && d.write('<script>document.domain="' + e + '"</script>'), d.close(), b.location.hash = a)
        }
      }(), f
    }()
  }(jQuery, window, document, void 0)), vui.hotkeyArray = {}, vui.hotkey = function (a, b) {
    a.event = a.event.toLowerCase(), a.key = a.key.toLowerCase();
    var c = /^keypress|keydown|keyup$/;
    if (c.test(a.event)) {
      var d = {
        27: "esc",
        9: "tab",
        32: "space",
        13: "enter",
        8: "backspace",
        145: "scrollclock",
        20: "capslock",
        144: "numlock",
        19: "pause",
        45: "insert",
        36: "home",
        46: "delete",
        35: "end",
        33: "pageup",
        34: "pagedown",
        37: "left",
        38: "up",
        39: "right",
        40: "down",
        112: "f1",
        113: "f2",
        114: "f3",
        115: "f4",
        116: "f5",
        117: "f6",
        118: "f7",
        119: "f8",
        120: "f9",
        121: "f10",
        122: "f11",
        123: "f12",
        191: "/",
        17: "ctrl",
        16: "shift",
        109: "-",
        107: "=",
        219: "[",
        221: "]",
        220: "\\",
        222: "'",
        187: "=",
        188: ",",
        189: "-",
        190: ".",
        191: "/",
        96: "0",
        97: "1",
        98: "2",
        99: "3",
        100: "4",
        101: "5",
        102: "6",
        103: "7",
        104: "8",
        105: "9",
        106: "*",
        110: ".",
        111: "/",
        65: "a",
        66: "b",
        67: "c",
        68: "d",
        69: "e",
        70: "f",
        71: "g",
        72: "h",
        73: "i",
        74: "j",
        75: "k",
        76: "l",
        77: "m",
        78: "n",
        79: "o",
        80: "p",
        81: "q",
        82: "r",
        83: "s",
        84: "t",
        85: "u",
        86: "v",
        87: "w",
        88: "x",
        89: "y",
        90: "z"
      };
      vui.hotkeyArray[a.name] = b, $(document).bind(a.event, function (b) {
        var c = 0;
        $.each(d, function (b) {
          return d[b] == a.key ? (c = b, !1) : void 0
        }), b.which == c && vui.hotkeyArray[a.name]()
      })
    }
  }, vui.unhotkey = function (a) {
    delete vui.hotkeyArray[a]
  }, vui.inputCursor = {
    getSelection: function (a) {
      var b, c, d, e, f, g = 0,
        h = 0;
      return "number" == typeof a.selectionStart && "number" == typeof a.selectionEnd ? (g = a.selectionStart, h = a.selectionEnd) : (c = document.selection.createRange(), c && c.parentElement() == a && (e = a.value.length, b = a.value.replace(/\r\n/g, "\n"), d = a.createTextRange(), d.moveToBookmark(c.getBookmark()), f = a.createTextRange(), f.collapse(!1), d.compareEndPoints("StartToEnd", f) > -1 ? g = h = e : (g = -d.moveStart("character", -e), g += b.slice(0, g).split("\n").length - 1, d.compareEndPoints("EndToEnd", f) > -1 ? h = e : (h = -d.moveEnd("character", -e), h += b.slice(0, h).split("\n").length - 1)))), {
        start: g,
        end: h
      }
    },
    getStartPos: function (a) {
      return this.getSelection(a).start
    },
    getEndPos: function (a) {
      return this.getSelection(a).end
    },
    insert: function (a, b) {
      document.selection ? (a.focus(), sel = document.selection.createRange(), sel.text = b, a.focus()) : a.selectionStart || "0" == a.selectionStart ? (startPos = a.selectionStart, endPos = a.selectionEnd, scrollTop = a.scrollTop, a.value = a.value.substring(0, startPos) + b + a.value.substring(endPos, a.value.length), a.focus(), a.selectionStart = startPos + b.length, a.selectionEnd = startPos + b.length, a.scrollTop = scrollTop) : (a.value += b, a.focus())
    },
    select: function (a, b, c) {
      if (("undefined" == typeof c || b > c) && (c = b), a.focus(), document.selection) {
        var d = a.createTextRange();
        d.move("character", b), d.moveEnd("character", c), d.select()
      } else a.selectionStart = b, a.selectionEnd = c
    },
    replace: function (a, b, c, d, e) {
      a.value = a.value.substr(0, b) + d + a.value.substr(c, a.value.length), e && this.select(a, b + d.length)
    }
  }, vui.isScroll = function (a, b) {
    b = $.extend({
      wrapWidth: 500,
      wrapHeight: 200,
      wrapClass: "isScrollWrap",
      scrollWidth: 20,
      scrollMinHeight: 50,
      scrollClass: "isScroll",
      step: 5,
      setScrollOnce: !1
    }, b);
    var c = {
      init: function () {
        a.data("data", b), b.setScrollOnce ? (b = a.data("data"), this.setScrollHeight(), this.dragInit()) : this.setInit()
      },
      setInit: function () {
        this.styleInit(), this.createWrap(), this.createScroll(), this.setScrollHeight(), this.bind(), this.dragInit()
      },
      bind: function () {
        var a = this,
          c = "mousewheel";
        vui.browser.firefox && (c = "DOMMouseScroll"), $("." + b.wrapClass).bind(c, function (b) {
          var c = b.wheelDelta;
          vui.browser.firefox && (c = -b.detail), a.step(c), b.preventDefault()
        })
      },
      setContentTop: function (c) {
        var d = a.outerHeight(),
          e = b.wrapHeight,
          f = this.getElementHeight($("." + b.scrollClass)),
          g = [(d - e) / (e - f)] * c;
        a.css({
          top: -g
        })
      },
      dragInit: function () {
        var a = this;
        vui.drag($("." + b.scrollClass), {
          lockX: !0,
          maxTop: 0,
          maxBottom: b.wrapHeight - this.getElementHeight($("." + b.scrollClass)),
          drag: a.drag
        })
      },
      drag: function (a) {
        c.setContentTop(a)
      },
      scrollTopValue: 0,
      step: function (c) {
        var d = a.outerHeight(),
          e = b.wrapHeight,
          f = this.getElementHeight($("." + b.scrollClass)),
          g = b.step * parseInt((d - e) / e),
          h = 1 / g * (e - f);
        0 > c ? this.scrollTopValue += h : this.scrollTopValue -= h, this.scrollTopValue > e - f && 0 > c && (this.scrollTopValue = e - f), this.scrollTopValue < 0 && c > 0 && (this.scrollTopValue = 0), $("." + b.scrollClass).css({
          top: this.scrollTopValue
        }), this.setContentTop(this.scrollTopValue)
      },
      setScrollHeight: function () {
        var c = a.outerHeight() - b.wrapHeight;
        if (0 > c) this.hide();
        else {
          var d = a.outerHeight(),
            e = b.wrapHeight,
            f = parseInt(e * e / d);
          f < b.scrollMinHeight && (f = b.scrollMinHeight), $("." + b.scrollClass).css({
            height: f
          }), this.show()
        }
      },
      getElementHeight: function (a) {
        var b = a.css("height"),
          c = parseFloat(b.slice(0, b.length - 2));
        return c
      },
      createWrap: function () {
        var c = $(document.createElement("div"));
        c.addClass(b.wrapClass), a.after(c), c.append(a);
        var d = {
          position: "relative",
          overflow: "hidden",
          width: b.wrapWidth,
          height: b.wrapHeight,
          border: "2px solid blue"
        };
        c.css(d)
      },
      createScroll: function () {
        var c = $(document.createElement("div"));
        c.addClass(b.scrollClass), a.after(c);
        var d = {
          position: "absolute",
          right: 0,
          top: 0,
          width: b.scrollWidth,
          backgroundColor: "#333"
        };
        c.css(d)
      },
      styleInit: function () {
        a.css({
          position: "absolute",
          left: 0,
          top: 0
        })
      },
      show: function () {
        $("." + b.scrollClass).show()
      },
      hide: function () {
        $("." + b.scrollClass).hide()
      }
    };
    c.init()
  }, vui.isArray = function (a) {
    return "[object Array]" === Object.prototype.toString.apply(a)
  }, vui.isEmpty = function (a) {
    return null === a || "undefined" == typeof a || 0 === a || a === !1 || "" === a || "number" == typeof a.length && 0 === a.length
  }, vui.isNumber = function (a) {
    return "number" == typeof a
  }, vui.isString = function (a) {
    return "string" == typeof a
  }, vui.isBoolean = function (a) {
    return "boolean" == typeof a
  }, vui.isObject = function (a) {
    return "object" == typeof a
  }, vui.isFunction = function (a) {
    return "function" == typeof a
  }, vui.isUndefined = function (a) {
    return void 0 === o
  }, vui.isNull = function (a) {
    return null === o
  }, vui.log = function (a) {
    window.console && console.log(a)
  }, vui.maxlength = vui.maxLength = jQuery.fn.maxlength = jQuery.fn.maxLength = function (a) {
    function b(a) {
      var b = new RegExp("(http://)+(([-A-Za-z0-9]+(.[-A-Za-z0-9]+)*(.[-A-Za-z]{2,5}))|([0-9]{1,3}(.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_$.+!*(),;:@&=?/~#%]*)*", "gi"),
        d = a.length;
      if (d > 0) {
        for (var e = 41, f = 140, g = a, h = a.match(b) || [], i = 0, j = 0, d = h.length; d > j; j++) {
          var k = c(h[j]);
          k > e && (i += f >= k ? 21 : 21 + (k - f) / 2, g = g.replace(h[j], ""))
        }
        return Math.ceil(i + c(g) / 2)
      }
      return 0
    }

    function c(a) {
      if ("undefined" == typeof a) return 0;
      var b = a.match(/[^\x00-\x80]/g);
      return a.length + (b ? b.length : 0)
    }

    function d() {
      var c = b(e.val());
      c > a.maxCharacters ? (f.html('<em>已超过</em><span class="errorNum">' + (c - a.maxCharacters) + "</span><em>字</em>"), $("span", f).addClass(a.errorClass), g.attr("disabled", "disabled")) : (f.html("<em>还可以输入</em>" + (a.maxCharacters - c) + "<em>字</em>"), $("span", f).removeClass(a.errorClass), g.removeAttr("disabled")), 0 == c && g.attr("disabled", "disabled")
    }
    var e = $(this);
    a = $.extend({
      maxCharacters: 140,
      numClass: "num",
      btnClass: "btn",
      errorClass: "W_error"
    }, a);
    var f = $("." + a.numClass),
      g = $("." + a.btnClass);
    d(), e.keyup(function () {
      d()
    })
  }, vui.menu = function (a) {
    a = $.extend({
      menuTop: $("#menuTop"),
      menu: $("#menu"),
      type: "click",
      autoShow: !1,
      css: {
        left: null,
        top: null
      }
    }, a);
    var b = {
      init: function () {
        a.menu.appendTo("body"), "click" == a.type ? (b.clickhide(), a.menuTop.mouseup(function () {
          return b.showTag ? b.close() : b.show(), !1
        })) : "hover" == a.type && (a.menuTop.click(function () {
          b.show()
        }), a.menuTop.bind("mouseover", function () {
          b.show()
        }))
      },
      showTag: !1,
      show: function () {
        vui.stick(null != a.css.left || null != a.css.top ? {
          stick: a.menuTop,
          stickTo: a.menu,
          autoShow: a.autoShow,
          css: {
            type: 1,
            top: a.css.top,
            left: a.css.left
          }
        } : {
          stick: a.menuTop,
          autoShow: a.autoShow,
          stickTo: a.menu,
          scrollMenu: a.scrollMenu
        }), b.showTag = !0
      },
      close: function () {
        a.menu.hide(), b.showTag = !1
      },
      mouseInsideTag: !1,
      clickhide: function () {
        a.menu.click(function () {
          b.close()
        }), a.menu.hover(function () {
          b.mouseInsideTag = !0
        }, function () {
          b.mouseInsideTag = !1
        }), $("html,body").mouseup(function () {
          b.mouseInsideTag ? b.show() : b.close()
        })
      }
    };
    b.init()
  }, vui.pageSize = function () {
    var a, b, c, d, e;
    e = "BackCompat" == document.compatMode ? document.body : document.documentElement, a = e.clientWidth, b = e.clientHeight, c = Math.max(a, e.scrollWidth), d = Math.max(b, e.scrollHeight);
    var f = {};
    return f.clientWidth = a, f.clientHeight = b, f.docWidth = c, f.docHeight = d, f
  }, vui.preventScroll = {
    mousewheelEvent: /Firefox/i.test(navigator.userAgent) ? "DOMMouseScroll" : "mousewheel",
    isIE: document.attachEvent ? !0 : !1,
    init: function () {
      this.isIE ? document.attachEvent("on" + this.mousewheelEvent, this.handler, !1) : document.addEventListener(this.mousewheelEvent, this.handler, !1)
    },
    destroy: function () {
      this.isIE ? document.detachEvent("on" + this.mousewheelEvent, this.handler, !1) : document.removeEventListener(this.mousewheelEvent, this.handler, !1)
    },
    handler: function (a) {
      vui.preventScroll.isIE ? a.returnValue = !1 : a.preventDefault()
    }
  }, vui.selectCode = function (a, b, c) {
    var d = a.value.length;
    if (!(0 > b || 0 > c))
      if (b > d && (b = d), c > d && (c = d), a.createTextRange) {
        var e = a.createTextRange();
        e.moveStart("character", -d), e.moveEnd("character", -d), e.moveStart("character", b), e.moveEnd("character", c), e.select()
      } else a.setSelectionRange(b, c), a.focus()
  }, vui.selectFileName = function (a, b) {
    var c = a.value,
      d = c.lastIndexOf(".");
    (-1 == d || "all" == b) && (d = c.length), vui.selectCode(a, 0, d)
  }, vui.slide = function (a, b) {
    b = $.extend({
      direction: "left",
      autoPlay: !0,
      time: 1800,
      eventType: "mouseover"
    }, b || {});
    var c, d, e = a,
      f = $(".slide-wrap", e),
      g = $(".slide", f),
      h = $("li", g),
      i = f.innerHeight(),
      j = f.innerWidth(),
      k = h.innerHeight(),
      l = h.innerWidth(),
      m = h.length,
      n = k * m,
      o = l * m,
      p = Math.ceil(i / k),
      q = Math.ceil(m / p),
      r = 0,
      s = 0;
    "left" == b.direction && (n = o, k = l, p = Math.ceil(j / l), g.width(o)), c = p - m % p, m % p == 0 && (c = 0), d = n + k * c, f.css({
      position: "relative"
    }), g.css({
      position: "absolute"
    }), h.css("float", "left");
    var t = h.slice(0, p);
    t.css({
      position: "relative"
    });
    var u = $(".slide-trigger a", e);
    u.eq(0).addClass("select");
    var v = {
      stop: function () {
        g.stop(), clearInterval(slideInterval)
      },
      run: function () {
        g.stop(), slideInterval = setInterval(v.sum, b.time)
      },
      sum: function () {
        s = s >= q - 1 ? 0 : s + 1, v.item(s)
      },
      item: function (a) {
        v.step(a), v.focus(a)
      },
      setCss: function (a, b) {
        var c = {};
        return c[a] = b, c
      },
      step: function (a) {
        return 0 == a && (a = m), r = -a * p * k, -n >= r ? (t.css(v.setCss(b.direction, d)), void g.animate(v.setCss(b.direction, -d), .9 * b.time, function () {
          $(this).css(v.setCss(b.direction, 0)), t.css(v.setCss(b.direction, 0))
        })) : void g.animate(v.setCss(b.direction, r), b.time)
      },
      focus: function (a) {
        u.removeClass("select"), u.eq(a).addClass("select")
      }
    };
    $.each(u, function (a) {
      var c = u.eq(a);
      c[b.eventType](function () {
        v.stop(), v.item(a)
      }), c.mouseout(function () {
        v.run()
      })
    }), b.autoPlay && v.run()
  }, vui.stick = function (a) {
    function b() {
      var b = {};
      if (a.css.type) {
        if (b = {
            top: a.css.top,
            left: a.css.left
          }, a.autoShow) {
          var c = $(window).height() + $(document).scrollTop(),
            d = b.top + a.stickTo.outerHeight();
          d > c && (b.top = b.top - a.stickTo.outerHeight())
        }
      } else if (b = {
          top: a.stick.offset().top + a.css.top + a.stick.outerHeight(),
          left: a.stick.offset().left + a.css.left
        }, a.autoShow) {
        var c = $(window).height() + $(document).scrollTop(),
          d = b.top + a.stickTo.outerHeight();
        d > c && (b.top = a.stick.offset().top - a.stickTo.outerHeight())
      }
      return b
    }
    a = $.extend({
      stick: null,
      stickTo: null,
      resize: !0,
      scroll: !1,
      autoShow: !1,
      css: {
        type: 0,
        position: "absolute",
        top: 0,
        left: 0,
        zIndex: 2
      }
    }, a), a.stickTo.css({
      position: "absolute",
      zIndex: a.css.zIndex,
      top: b().top,
      left: b().left
    }).show(), a.resize && $(window).resize(function () {
      a.stickTo.css(b())
    }), a.scroll && $(window).scroll(function () {
      a.stickTo.css(b())
    }), a.scrollMenu && $(window).scroll(function () {
      a.stickTo.css(b())
    })
  }, define("2/core", [], function (require, a, b) {
    function c(a, b) {
      void 0 === b && (b = 0), void 0 === a && (a = ""), this._prefix = a, this._counter = b
    }
    var d = {};
    d.whiteUid = ["3810651093"], d.login = function () {
      function a() {
        if (20 >= b) {
          var c = $(".W_outFrame[node-type=outer]");
          if (c.length && 10009 != c.css("zIndex")) {
            if (c.css("zIndex", 10009), b = 0, !window.XMLHttpRequest && $(".W_outFrame .W_layer .content").length) {
              var d = $(".W_outFrame .W_layer .content").width();
              $(".W_outFrame .W_layer").css("width", d), c.css("left", ($(window).width() - d) / 2)
            }
          } else b++, setTimeout(a, 100)
        }
      }
      if ("undefined" != typeof WBtopPublic && "function" == typeof WBtopPublic.showLoginLayer) {
        WBtopPublic.showLoginLayer();
        var b = 0;
        a()
      } else window.location.href = "/login"
    }, d.api = function (a, b, c, e) {
      var f = {
        cache: !1,
        validate: function (a) {
          return null !== a
        },
        headers: {
          "x-response-version": "2"
        }
      };
      return a = $.extend({}, a, f), a.url.indexOf("://") > -1 || "/" === a.url[0] || (a.url = APP_URL + a.url), a.dataType = a.dataType || "json", a.success = function (e) {
        a.validate(e) ? null !== e && "object" == typeof e && e.error_code ? "A401" === e.error_code ? d.login() : c && c(e) : b && b(e) : c && c({
          error_code: "A500",
          error: "加载失败"
        })
      }, a.error = function (a, b, d) {
        "abort" === a.statusText || c && c({
          error_code: "A000",
          error: "加载失败了！"
        })
      }, a.complete = function (a, b) {
        e && e(a, b)
      }, $.ajax(a)
    }, d.api.get = function () {
      return d.api.apply(null, arguments)
    }, d.api.post = function () {
      return arguments[0].type = "POST", d.api.apply(null, arguments)
    }, d.extend = $.extend, d.path = {
      basename: function (a, b) {
        var c = a.replace(/^.*[\/\\]/g, "");
        return "string" == typeof b && c.substr(c.length - b.length) == b && (c = c.substr(0, c.length - b.length)), c
      },
      dirname: function (a) {
        var b = a.replace(/\\/g, "/").replace(/\/[^\/]*\/?$/, "");
        return "/" === a[0] && "" === b ? "/" : b
      },
      extension: function (a, b) {
        var c = d.path.basename(a),
          e = "";
        return c.indexOf(".") > -1 && (e = c.split(".").pop(), b && (e = e.toLowerCase(e))), e
      },
      join: function () {
        var a = Array.prototype.slice.call(arguments).join("/");
        return a.replace(/\/{2,}/g, "/")
      },
      normpath: function (a) {
        var b = a.replace(/\/{2,}/g, "/");
        return "/" !== b[0] && (b = "/" + b), b
      },
      encodeURI: function (a) {
        for (var b = a.split("/"), c = 0; c < b.length; c++) b[c] = encodeURIComponent(b[c]);
        return b.join("/")
      },
      decodeURI: function (a) {
        for (var b = a.split("/"), c = 0; c < b.length; c++) b[c] = decodeURIComponent(b[c]);
        return b.join("/")
      }
    }, d.thumb = {
      getSize: function (a, b) {
        return a.replace("/maxsize.60/", "/" + b + "/")
      }
    }, d.icon = function (a) {
      for (var b = [["pic", ["ai", "bmp", "gif", "jpeg", "jpg", "png", "psd", "raw"]], ["apk", ["apk"]], ["ipa", ["ipa"]], ["csv", ["csv"]], ["book", ["epub"]], ["txt", ["txt", "rtf"]], ["wps", ["wps"]], ["doc", ["doc", "docx"]], ["pdf", ["pdf"]], ["ppt", ["pps", "ppsx", "ppt", "pptx"]], ["xls", ["xlsx", "xls"]], ["music", ["mp3", "wma", "aac", "ape", "flac", "wav"]], ["video", ["flv", "ai", "mov", "mpeg", "raw", "mp4", "rmvb", "rm", "3gp", "mkv", "avi", "mpg", "wmv"]], ["exe", ["exe"]], ["swf", ["swf"]], ["xap", ["xap"]], ["html", ["html"]], ["rar", ["rar", "zip", "tar", "bz2", "gz"]]], c = d.path.extension(a, !0), e = b.length - 1; e >= 0; e--)
        for (var f = b[e][1].length - 1; f >= 0; f--)
          if (b[e][1][f] === c) return b[e][0];
      return "other"
    }, d.icon.position = function (a) {
      for (var b = [["pic", ["ai", "bmp", "gif", "jpeg", "jpg", "png", "psd", "raw"]], ["apk", ["apk"]], ["ipa", ["ipa"]], ["csv", ["csv"]], ["book", ["epub"]], ["txt", ["txt", "rtf"]], ["wps", ["wps"]], ["doc", ["doc", "docx"]], ["pdf", ["pdf"]], ["ppt", ["pps", "ppsx", "ppt", "pptx"]], ["xls", ["xlsx", "xls"]], ["music", ["mp3", "wma", "aac", "ape", "flac", "wav"]], ["video", ["flv", "ai", "mov", "mpeg", "raw", "mp4", "rmvb", "rm", "3gp", "mkv", "avi", "mpg", "wmv"]], ["exe", ["exe"]], ["swf", ["swf"]], ["xap", ["xap"]], ["html", ["html"]], ["rar", ["rar", "zip", "tar", "bz2", "gz"]]], c = d.path.extension(a, !0), e = b.length - 1; e >= 0; e--)
        for (var f = b[e][1].length - 1; f >= 0; f--)
          if (b[e][1][f] === c) return f;

      return 0
    }, d.format = {
      formatsize: function (a, b) {
        var c = ["B", "K", "M", "G", "T", "P", "E", "Z", "Y"],
          d = 0;
        for (void 0 === b && (b = 2); a > 1024;) a /= 1024, ++d;
        if (a % 1 == 0) return a + "" + c[d];
        var e = Math.pow(10, b);
        return "" + Math.round(a * e) / e + c[d]
      },
      formatDate: function (a) {
        var b = a.getHours(),
          c = a.getMinutes();
        return 10 > b && (b = "0" + b), 10 > c && (c = "0" + c), a.getFullYear() + "-" + (a.getMonth() + 1) + "-" + a.getDate() + " " + b + ":" + c
      },
      formatDateString: function (a) {
        var b = new Date(a);
        return this.formatDate(b)
      },
      formatTimestamp: function (a) {
        var b = new Date(1e3 * a);
        return this.formatDate(b)
      },
      formatMyDate: function (a, b) {
        if (void 0 == a) return "";
        var c = new Date(1e3 * a),
          d = new Date(1e3 * b),
          e = c.getMinutes(),
          f = c.getHours();
        if (c.getFullYear() == d.getFullYear() && c.getMonth() + 1 == d.getMonth() + 1 && c.getDate() == d.getDate()) return 10 > e && (e = "0" + e), 10 > f && (f = "0" + f), "今天 " + f + ":" + e;
        10 > e && (e = "0" + e), 10 > f && (f = "0" + f);
        var g = c.getFullYear() + "-" + (c.getMonth() + 1) + "-" + c.getDate() + " " + f + ":" + e;
        return g
      }
    }, d.text = {
      mbCut: function (a, b, c) {
        var d = 0,
          e = "",
          f = /[^\x00-\xff]/g,
          g = "",
          h = a.replace(f, "**").length;
        void 0 === b && (b = 18), b *= 2;
        for (var i = 0; h > i && (g = a.charAt(i).toString(), null != g.match(f) ? d += 2 : d++, !(d > b)); i++) e += g;
        return c !== !1 && h > b && (e += "..."), e
      },
      mbWidth: function (a) {},
      encodeHtml: function (a, b) {
        return void 0 === b && (b = 3), a = a.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"), (1 == b || 3 == b) && (a = a.replace(/'/g, "&#039;")), (2 == b || 3 == b) && (a = a.replace(/"/g, "&quot")), a
      },
      trimChinese: function (a) {
        return a.replace(/^(\s|　)+|(\s|　)+$/g, "")
      }
    }, c.prototype = {
      get: function () {
        return this._prefix + this._counter++
      }
    };
    var e = new c("vdom_");
    d.domId = function () {
      return e.get()
    };
    var f = !1;
    return d.downloadFile = function (a) {
      var b = "frame_download";
      f ? $("#" + b).attr("src", a) : ($("body").append('<iframe id="' + b + '" width="0" height="0" src="' + a + '"></iframe>'), f = !0)
    }, d
  });
